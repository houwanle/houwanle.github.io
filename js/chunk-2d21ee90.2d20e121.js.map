{"version":3,"sources":["webpack:///./src/views/operation-manage/components/business-log.vue?69da","webpack:///src/views/operation-manage/components/business-log.vue","webpack:///./src/views/operation-manage/components/business-log.vue?7734","webpack:///./src/views/operation-manage/components/business-log.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticStyle","_v","style","width","base","height","attrs","model","value","callback","$$v","businessName","expression","on","importDateChange","dateData","$event","changePage","triggerButtonStatus","triggerDetection","columns1","data1","tabHeight","totalCount","pageNo","changePageSize","staticRenderFns","data","loadingStatus","logType","current","pageSize","created","queryBusinessLog","init","mounted","autoFix","methods","getDom","window","onresize","vm","forEach","item","h","val","type","date","name","api","setTimeout","Num","size","component"],"mappings":"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","file":"js/chunk-2d21ee90.2d20e121.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('Card',{staticStyle:{\"margin\":\"10px\"}},[_c('Row',[_c('Col',{staticStyle:{\"display\":\"flex\",\"justify-content\":\"flex-start\"}},[_c('div',[_c('span',{staticStyle:{\"margin-left\":\"18px\",\"font-size\":\"14px\",\"font-family\":\"Microsoft YaHei\",\"font-weight\":\"400\",\"color\":\"rgba(255,255,255,1)\"}},[_vm._v(\"业务名称\")]),_c('Input',{style:({width:180 * _vm.base + 'px', height:'32px', 'margin-left':'9px','border-radius':'2px'}),attrs:{\"placeholder\":\"请输入\"},model:{value:(_vm.businessName),callback:function ($$v) {_vm.businessName=$$v},expression:\"businessName\"}})],1),_c('div',{staticStyle:{\"margin-left\":\"50px\"}},[_c('span',{staticStyle:{\"font-size\":\"14px\",\"font-family\":\"Microsoft YaHei\",\"font-weight\":\"400\",\"color\":\"rgba(255,255,255,1)\"}},[_vm._v(\"日期\")]),_c('DatePicker',{style:({width:200 * _vm.base + 'px','margin-left':'9px'}),attrs:{\"format\":\"yyyy-MM-dd\",\"type\":\"date\",\"placeholder\":\"请选择\"},on:{\"on-change\":_vm.importDateChange},model:{value:(_vm.dateData),callback:function ($$v) {_vm.dateData=$$v},expression:\"dateData\"}})],1),_c('div',[_c('span',{staticStyle:{\"margin\":\"15px 30px\"}},[_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.changePage(1)}}},[_vm._v(\"查询\")])],1)])])],1)],1),_c('Card',{staticStyle:{\"margin\":\"10px\"}},[_c('div',[_c('Button',{attrs:{\"type\":\"primary\",\"disabled\":_vm.triggerButtonStatus},on:{\"click\":function($event){return _vm.triggerDetection()}}},[_vm._v(\"手动触发检测\")])],1),_c('div',{staticStyle:{\"margin-top\":\"10px\"}},[_c('Table',{attrs:{\"columns\":_vm.columns1,\"data\":_vm.data1,\"height\":_vm.tabHeight}}),_c('Page',{staticStyle:{\"text-align\":\"right\",\"margin\":\"20px 0\"},attrs:{\"total\":_vm.totalCount,\"current\":_vm.pageNo,\"show-sizer\":\"\",\"show-total\":\"\",\"show-elevator\":\"\",\"placement\":\"top\"},on:{\"on-change\":_vm.changePage,\"on-page-size-change\":_vm.changePageSize}})],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <Card style=\"margin:10px;\">\r\n      <Row>\r\n        <Col style=\"display:flex;justify-content:flex-start;\">\r\n          <div>\r\n            <span style=\"margin-left:18px;font-size:14px;font-family:Microsoft YaHei;font-weight:400;color:rgba(255,255,255,1);\">业务名称</span>\r\n            <Input \r\n              v-model=\"businessName\" \r\n              placeholder=\"请输入\"\r\n              :style=\"{width:180 * base + 'px', height:'32px', 'margin-left':'9px','border-radius':'2px'}\"\r\n            ></Input>\r\n          </div>\r\n          <div style=\"margin-left:50px\">\r\n            <span style=\"font-size:14px;font-family:Microsoft YaHei;font-weight:400;color:rgba(255,255,255,1);\">日期</span>\r\n            <DatePicker \r\n              format=\"yyyy-MM-dd\" \r\n              type=\"date\" \r\n              v-model=\"dateData\" \r\n              @on-change=\"importDateChange\" \r\n              placeholder=\"请选择\"\r\n              :style=\"{width:200 * base + 'px','margin-left':'9px'}\"\r\n            ></DatePicker>\r\n          </div>\r\n          <div>\r\n            <span style=\"margin: 15px 30px;\">\r\n              <Button type=\"primary\" @click=\"changePage(1)\">查询</Button>\r\n            </span>\r\n          </div>\r\n        </Col>\r\n      </Row>\r\n    </Card>\r\n    <Card style=\"margin:10px;\">\r\n      <div>\r\n        <Button type=\"primary\" @click=\"triggerDetection()\" :disabled=\"triggerButtonStatus\">手动触发检测</Button>\r\n      </div>\r\n      <div style=\"margin-top:10px;\">\r\n        <Table :columns=\"columns1\" :data=\"data1\" :height=\"tabHeight\"></Table>\r\n        <Page \r\n          :total=\"totalCount\" \r\n          :current=\"pageNo\" \r\n          @on-change=\"changePage\" \r\n          @on-page-size-change=\"changePageSize\" \r\n          show-sizer \r\n          show-total \r\n          show-elevator \r\n          placement=\"top\" \r\n          style=\"text-align:right;margin:20px 0\"/>\r\n      </div>\r\n    </Card>\r\n  </div>\r\n</template>\r\n<script>\r\nimport api from '@/api/api';\r\nexport default {\r\n  data () {\r\n    return {\r\n      // 操作日志表格数据\r\n      columns1: [\r\n        {\r\n          title: '业务名称',\r\n          key: 'name'\r\n        },\r\n        {\r\n          title: '描述',\r\n          key: 'moduleDescription'\r\n        },\r\n        {\r\n          title: '日志记录状态',\r\n          key: 'status'\r\n        },\r\n        {\r\n          title: '日期',\r\n          key: 'createAt'\r\n        },\r\n      ],\r\n\r\n      data1: [\r\n        {\r\n          businessName: '通道1输入流状态',\r\n          description: '通道1输入流状态',\r\n          LogStatus: '正常',\r\n          date: '2020-06-21 17:21:21',\r\n        },\r\n        {\r\n          businessName: '通道2输入流状态',\r\n          description: '通道2输入流状态',\r\n          LogStatus: '正常',\r\n          date: '2020-06-21 17:21:21',\r\n        },\r\n        {\r\n          businessName: '通道3输入流状态',\r\n          description: '通道3输入流状态',\r\n          LogStatus: '异常',\r\n          date: '2020-06-21 17:21:21',\r\n        },\r\n      ],\r\n\r\n      dateData:'',\r\n      loadingStatus:false,\r\n      logType:1, // 日志类型：0、启动日志；1为业务日志\r\n      businessName:'', // 业务名称\r\n      triggerButtonStatus:false, // 手动触发检测按钮 置灰开关，默认为 不置灰。\r\n\r\n      // 分页\r\n      current:1,\r\n      totalCount:0,\r\n      pageNo:1,\r\n      pageSize:10,\r\n\r\n      base:1,   // 分辨率自适应 计算后的倍数\r\n      tabHeight:0,  // 分辨率自适应调整：表格的高度\r\n    }   \r\n  },\r\n  created(){\r\n    this.queryBusinessLog();\r\n    this.init();\r\n  },\r\n  mounted(){\r\n    this.autoFix();\r\n  },\r\n  methods:{\r\n    /** 自适应 */\r\n    autoFix(){\r\n      let vm = this;\r\n      this.getDom();\r\n      window.onresize = function(){\r\n        vm.getDom();\r\n      }\r\n    },\r\n\r\n    /** 获取窗口的宽和高 */\r\n    getDom(){\r\n      let width = window.innerWidth;\r\n      let height = window.innerHeight;\r\n      this.base = (width-160)/(1024-160);\r\n      this.tabHeight = height - 350;  // 表格页面有“过滤搜索条件”card，表格上方有Button，则采用该方式计算。\r\n      // this.tabHeight = height - 325;  // 表格页面有“过滤搜索条件”card，表格上方无Button，则采用该方式计算。\r\n      // this.tabHeight = height - 275;  // 表格页面无 “过滤搜索条件”card,但表格上方有Button，则采用该方式计算。\r\n      // this.tabHeight = height - 250;   // 表格页面无 “过滤搜索条件”card,表格上方无Button，则采用该方式计算。\r\n    },\r\n\r\n    init(){\r\n      /** 渲染自定义组件 */\r\n      let vm = this;\r\n      this.columns1.forEach(item => {\r\n        if(item.key === 'status') {\r\n          item.render = (h, param) => {\r\n            return h('div', [\r\n              h(\r\n                'span',\r\n                {\r\n                  props: {\r\n                    type:'text',\r\n                  },\r\n                  style: {\r\n                    color:param.row.status===0?'rgba(2,232,255,1)':'rgba(245,108,108,1)',\r\n                  },\r\n                }, param.row.status === 0?'正常':'异常'\r\n              )\r\n            ])\r\n          }\r\n        }\r\n      })\r\n    },\r\n\r\n    importDateChange(val){\r\n      this.dateData = val;\r\n    },\r\n\r\n    /** 查询业务日志 */\r\n    queryBusinessLog(){\r\n      let param = {\r\n        type:this.logType,\r\n        date:this.dateData,\r\n        name:this.businessName,\r\n        pageNo:this.pageNo,\r\n        pageSize:this.pageSize,\r\n      }\r\n\r\n      this.data1 = [];\r\n      api.seacherDrbsSystemLogList(param).then(\r\n        res => {\r\n          this.totalCount = res.count;\r\n          res = res.result;\r\n          this.loadingStatus = false;\r\n          this.data1 = res;\r\n          if(this.data1.length === 0 && this.pageNo > 1){\r\n            this.pageNo--;\r\n            this.queryBusinessLog();\r\n          }\r\n        },\r\n        err => {\r\n          this.loadingStatus = false;\r\n        }\r\n      )\r\n    },\r\n\r\n    /** 手动触发检测 */\r\n    triggerDetection(){\r\n      this.triggerButtonStatus = true;\r\n\r\n      setTimeout(() => {\r\n        this.triggerButtonStatus = false;\r\n      }, 60000);\r\n      \r\n      let param = {}\r\n\r\n      api.businessLog(param).then(\r\n        res => {\r\n          this.$Message.success('正在检测，请3分钟后查看。');\r\n          this.queryBusinessLog();\r\n        }\r\n      )\r\n    },\r\n\r\n    /** 改变页面 */ \r\n    changePage(Num) {\r\n      this.pageNo = Num\r\n      this.queryBusinessLog();\r\n    },\r\n    \r\n    /** 改变页面条数 */ \r\n    changePageSize(size) {\r\n      this.pageSize = size\r\n      if (this.pageNo === 1) {\r\n        this.queryBusinessLog();\r\n      }\r\n    },\r\n  }  \r\n}\r\n</script>\r\n<style>\r\n\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./business-log.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./business-log.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./business-log.vue?vue&type=template&id=36a4b0a8&\"\nimport script from \"./business-log.vue?vue&type=script&lang=js&\"\nexport * from \"./business-log.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}