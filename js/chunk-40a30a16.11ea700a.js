(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-40a30a16","chunk-227cb4d7"],{"0ebd":function(e,t,a){},"131e":function(e,t,a){},"3f3f":function(e,t,a){"use strict";a("498a");var i=a("2b0e"),n=(new i["default"],{especilTest:function(e,t,a){t.trim()?a():a(new Error("请输入媒资名称"))},spaceTest:function(e,t,a){t.length!==t.trim().length?a(new Error("输入字符两侧不允许出现空格")):a()}});t["a"]=n},"498a":function(e,t,a){"use strict";var i=a("23e7"),n=a("58a8").trim,o=a("c8d2");i({target:"String",proto:!0,forced:o("trim")},{trim:function(){return n(this)}})},5330:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"role-admin"},[a("div",{staticStyle:{width:"100%",height:"38px",background:"rgba(13,67,111,1)","box-shadow":"0px 2px 10px 0px rgba(0, 0, 0, 0.05)","font-size":"14px","font-family":"Microsoft YaHei","font-weight":"400",color:"rgba(255,255,255,1)","padding-left":"24px","line-height":"38px"}},[e._v(" 角色管理 ")]),a("Row",[a("Col",{attrs:{span:"24"}},[a("Row",[a("Card",{staticStyle:{margin:"10px"}},[a("Col",{staticStyle:{display:"flex","justify-content":"flex-start"}},[a("div",[a("span",{staticStyle:{"margin-left":"28px","font-size":"14px","font-family":"Microsoft YaHei","font-weight":"400",color:"rgba(255,255,255,1)"}},[e._v("名称")]),a("Input",{style:{width:180*e.base+"px","margin-left":"9px"},attrs:{icon:"ios-close-empty",placeholder:"请输入",id:"roleName"},on:{"on-click":function(t){e.searchConName3="",e.handleSearch3Btn()}},model:{value:e.searchConName3,callback:function(t){e.searchConName3=t},expression:"searchConName3"}})],1),a("div",[a("span",{staticStyle:{margin:"0 30px"},on:{click:e.handleSearch3Btn}},[a("Button",{attrs:{type:"primary",disabled:e.loadingBtn}},[e._v("查询")])],1)])])],1),a("Card",{staticStyle:{margin:"10px"}},[a("div",{staticStyle:{display:"flex","justify-content":"flex-end"}},[a("Button",{staticStyle:{background:"rgba(13,67,111,1)",color:"rgba(199,219,244,1)"},attrs:{disabled:e.isGray},on:{click:e.creatButton}},[e._v("新建")])],1),a("div",{staticStyle:{"margin-top":"10px"}},[a("Table",{attrs:{loading:e.loading,columns:e.columns1,data:e.historyData,height:e.tabHeight}}),a("Page",{staticStyle:{margin:"20px 0","text-align":"right"},attrs:{placement:"top",total:e.dataCount,current:e.pageNumber,"show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)])],1)],1)],1),a("Modal",{attrs:{"class-name":"operatorList","mask-closable":!1},model:{value:e.modal5,callback:function(t){e.modal5=t},expression:"modal5"}},[a("p",{staticStyle:{"text-align":"left","padding-left":"5px"},attrs:{slot:"header"},slot:"header"},[e._v(" 操作员列表 ")]),a("div",{},[a("Table",{attrs:{columns:e.columns2,data:e.data1,height:"240",loading:e.handlerLoading}})],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("div")])])],1)},n=[],o=(a("a4d3"),a("e01a"),a("4160"),a("b0c0"),a("d3b7"),a("25f0"),a("159b"),a("b85c")),r=a("4ec3"),s=a("3f3f"),l={name:"RoleTable",data:function(){var e=s["a"].spaceTest;return{formValidate:{newName:"",newDescription:""},formValidate1:{oldName:"",oldDescription:""},ruleValidate:{newName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{validator:e},{max:50,message:"输入字符长度不允许超出50",trigger:"blur"}],newDescription:[{required:!0,message:"请输入角色描述",trigger:"blur"},{validator:e},{max:100,message:"输入字符长度不允许超出100",trigger:"blur"}],oldName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{validator:e},{max:50,message:"输入字符长度不允许超出50",trigger:"blur"}],oldDescription:[{required:!0,message:"请输入角色描述",trigger:"blur"},{validator:e},{max:100,message:"输入字符长度不允许超出100",trigger:"blur"}]},searchConName3:"",columns1:[{key:"name",title:"名称"},{key:"description",title:"描述"},{key:"createDate",title:"创建时间"},{key:"handle",title:"操作",align:"center"}],columns2:[{key:"roleName",title:"操作员名称"},{key:"isUse",title:"状态"}],handlerLoading:!1,handlerDetailLoading:!1,readonly:!0,data3:[],initTable3:[],ajaxHistoryData:[],dataCount:0,pageSize:10,pageNumber:1,historyData:[],current:1,modal1:!1,modal2:!1,searchResult:[],loading:!0,selectedItem:[],loadingBtn:!1,modal5:!1,modal6:!1,roleName:"",data1:[],isGray:!1,formItem:{handlerId:"",handleName:"",role:"",status:"",iphone:"",email:"",createTime:"",lastLoginTime:"",lastLoginIp:""},base:1,tabHeight:0}},created:function(){this.isGray=1!=JSON.parse(localStorage.getItem("loginRes")).user.operationPermissions,this.getTableList(),this.init()},mounted:function(){this.init(),this.autoFix()},methods:{autoFix:function(){var e=this;this.getDom(),window.onresize=function(){e.getDom()}},getDom:function(){var e=window.innerWidth,t=window.innerHeight;this.base=(e-160)/864,this.tabHeight=t-350},creatButton:function(){this.$router.push({name:"role-create"})},updateRoleInfo:function(e){e&&sessionStorage.setItem("roleParam",JSON.stringify(e)),this.$router.push({name:"role-update"})},init:function(){var e=this,t=this;this.columns1.forEach((function(a){"handle"===a.key&&(a.render=function(a,i){return a("div",[a("span",{props:{type:"text"},style:{marginRight:"8px",color:"#02E8FF",cursor:"pointer"},on:{click:function(){t.viewSysten(i.row)}}},"操作员列表"),a("span",{props:{type:"text"},style:{marginRight:"8px",color:e.isGray?"gray":"#02E8FF",cursor:e.isGray?"not-allowed":"pointer"},on:{click:function(){if(t.isGray)return!1;t.updateRoleInfo(i.row)}}},"修改"),a("Poptip",{props:{confirm:!0,title:"您确定要删除这条数据吗？",transfer:!0},on:{"on-ok":function(){t.removeByID(i.row)}}},[a("span",{style:{marginRight:"0",color:"#02E8FF",cursor:"pointer",display:e.isGray?"none":""}},"删除")]),a("span",{style:{marginRight:"0",color:"gray",cursor:"not-allowed",display:e.isGray?"":"none"}},"删除")])})}))},viewSysten:function(e){var t=this;this.handlerLoading=!0,this.data1=[],this.roleName=e.name;var a={};a.id=e.id,a.roleId=e.roleId,r["a"].roleAndHandler(a).then((function(e){if(e.status&&1222==e.status)return t.getTableList(),t.modal5=!1,!1;t.modal5=!0;var a,i=e.result,n=Object(o["a"])(i);try{for(n.s();!(a=n.n()).done;){var r=a.value,s={};s.roleName=r.username,s.userId=r.userId,s.id=r.id,s.isUse=!0===r.isEnabled?"已启用":"未启用",t.data1.push(s)}}catch(l){n.e(l)}finally{n.f()}t.handlerLoading=!1}),(function(e){t.handlerLoading=!1}))},showDetail:function(e){var t=this;this.modal6=!0,this.modal5=!1,this.handlerDetailLoading=!0;var a={id:e.id,userId:e.userId};r["a"].specificJson(a).then((function(e){var a,i=e.result,n="",r=Object(o["a"])(i.roles);try{for(r.s();!(a=r.n()).done;){var s=a.value;n+=s.roleName+" / "}}catch(d){r.e(d)}finally{r.f()}var l=n.length-2;n=n.substring(0,l),t.formItem.handlerId=i.id,t.formItem.handleName=i.name,t.formItem.status=!0===i.isEnabled?"已启用":"未启用",t.formItem.iphone=i.phone,t.formItem.email=i.email,t.formItem.role=n,t.formItem.createTime=i.createDate,t.formItem.lastLoginTime=i.loginDate,t.formItem.lastLoginIp=i.loginIp,t.handlerDetailLoading=!1}),(function(e){t.handlerDetailLoading=!1}))},shutHandlerDetaile:function(e){this.modal5=!0},getTableList:function(){var e=this,t={roleName:this.searchConName3,description:"",status:0,pageNo:this.pageNumber,pageSize:this.pageSize};this.loading=!0,r["a"].getRoleList(t).then((function(t){e.dataCount=t.count,t=t.result;for(var a=0;a<t.length;a++)e.traverseTree(t[a]);e.historyData=e.searchResult,e.loading=!1,e.loadingBtn=!1,e.searchResult=[],0===e.historyData.length&&e.pageNumber>1&&(e.pageNumber--,e.getTableList())}),(function(t){e.loading=!1,e.loadingBtn=!1}))},handleSearch3Btn:function(){this.loadingBtn=!0,this.pageNumber=1,this.getTableList()},handleSearch3:function(){this.loadingBtn=!0,this.getTableList()},changePage:function(e){this.pageNumber=e,this.getTableList()},changePageSize:function(e){this.pageSize=e,1===this.pageNumber&&this.getTableList()},removeByID:function(e){var t=this,a=e.id.toString(),i=e.roleId.toString(),n={ids:[a],roleIds:[i]};this.loading=!0,r["a"].deleteRole(n).then((function(e){if(e.status&&1222==e.status)return t.getTableList(),!1;t.$Message.success("角色删除成功"),t.dataCount%t.pageSize===1&&t.pageNumber===Math.ceil(t.dataCount/t.pageSize)&&t.pageNumber>1&&t.pageNumber--,t.getTableList()}),(function(e){t.loading=!1}))},submitInfo:function(e){var t=this;this.$refs[e].validate((function(e){if(e){var a={name:t.formValidate.newName,description:t.formValidate.newDescription};t.loading=!0,r["a"].creatRole(a).then((function(e){t.$Message.success("角色创建成功"),t.getTableList()}),(function(e){t.loading=!1,t.getTableList()})),t.modal1=!1,t.formValidate.newName="",t.formValidate.newDescription=""}else t.$Message.error("请输入符合规则的内容")}))},updateInfo:function(e){this.selectedItem=e,this.formValidate1.oldName=e.name,this.formValidate1.oldDescription=e.description},updateInfo1:function(e){var t=this;this.$refs[e].validate((function(e){if(e){var a={id:t.selectedItem.id,roleId:t.selectedItem.roleId,name:t.formValidate1.oldName,description:t.formValidate1.oldDescription};t.loading=!0,r["a"].updateRole(a).then((function(e){t.$Message.success("修改角色成功"),t.getTableList()}),(function(e){t.getTableList(),t.loading=!1})),t.modal2=!1}else t.$Message.error("请输入符合规则的内容")}))},getNowFormatDate:function(){var e=new Date,t="-",a=":",i=e.getMonth()+1,n=e.getDate();i>=1&&i<=9&&(i="0"+i),n>=0&&n<=9&&(n="0"+n);var o=e.getFullYear()+t+i+t+n+" "+e.getHours()+a+e.getMinutes()+a+e.getSeconds();return o},cancelModal:function(){this.reset("formValidate1"),this.formValidate.newName="",this.formValidate.newDescription="",this.modal1=!1,this.modal2=!1},traverseNode:function(e){var t={id:e.id,roleId:e.roleId,name:e.name,description:e.description,createDate:e.createDate,operationPermissions:e.operationPermissions};this.searchResult.push(t)},traverseTree:function(e){if(e){var t,a=[];a.push(e);while(a.length>0)if(t=a.pop(),this.traverseNode(t),t.permission&&t.permission.length>0){var i=t.permission.length-1;for(i=t.permission.length-1;i>=0;i--)a.push(t.permission[i])}}},reset:function(e){this.$refs[e].resetFields()}}},d=l,c=(a("72d6"),a("c2b9"),a("2877")),u=Object(c["a"])(d,i,n,!1,null,null,null);t["default"]=u.exports},"72d6":function(e,t,a){"use strict";var i=a("0ebd"),n=a.n(i);n.a},7893:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("role-table")},n=[],o=a("5330"),r={name:"RoleAdmin",components:{roleTable:o["default"]}},s=r,l=a("2877"),d=Object(l["a"])(s,i,n,!1,null,null,null);t["default"]=d.exports},c2b9:function(e,t,a){"use strict";var i=a("131e"),n=a.n(i);n.a},c8d2:function(e,t,a){var i=a("d039"),n=a("5899"),o="​᠎";e.exports=function(e){return i((function(){return!!n[e]()||o[e]()!=o||n[e].name!==e}))}}}]);
//# sourceMappingURL=chunk-40a30a16.11ea700a.js.map