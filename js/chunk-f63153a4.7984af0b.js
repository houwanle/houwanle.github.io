(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f63153a4"],{"2d74":function(e,t,r){},"3ecb":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticStyle:{width:"100%",height:"38px",background:"rgba(13,67,111,1)","box-shadow":"0px 2px 10px 0px rgba(0, 0, 0, 0.05)","font-size":"14px","font-family":"Microsoft YaHei","font-weight":"400",color:"rgba(255,255,255,1)","padding-left":"24px","line-height":"38px"}},[e._v(" 新建角色 ")]),r("Row",[r("Col",[r("Card",{staticStyle:{margin:"10px"},style:{height:e.tabHeight+"px"}},[r("Row",{staticStyle:{"margin-top":"20px"},attrs:{type:"flex",justify:"center"}},[r("Col",[r("Form",{ref:"roleNew",attrs:{model:e.roleNew,rules:e.roleNewRule,"label-position":"right","label-width":100}},[r("FormItem",{attrs:{label:"名称",prop:"roleName"}},[r("Input",{staticStyle:{width:"466px",height:"32px"},attrs:{type:"text",maxlength:20,placeholder:"请输入"},model:{value:e.roleNew.roleName,callback:function(t){e.$set(e.roleNew,"roleName",t)},expression:"roleNew.roleName"}}),r("span",{staticStyle:{color:"rgba(175,188,204,1)","margin-left":"10px"}},[e._v(e._s(e.roleNameLength)+"/20")])],1),r("FormItem",{attrs:{label:"描述",prop:"description"}},[r("Input",{staticStyle:{width:"466px",height:"32px"},attrs:{type:"text",maxlength:50,placeholder:"请输入"},model:{value:e.roleNew.description,callback:function(t){e.$set(e.roleNew,"description",t)},expression:"roleNew.description"}}),r("span",{staticStyle:{color:"rgba(175,188,204,1)","margin-left":"10px"}},[e._v(e._s(e.descriptionLength)+"/50")])],1),r("FormItem",{attrs:{label:"菜单权限"}},[r("div",{staticStyle:{width:"464px",height:"326px",border:"1px solid rgba(87,111,140,1)","border-radius":"2px","margin-top":"10px",overflow:"auto",background:"rgba(22,60,105,1)"},style:{height:e.tabHeight-320+"px"}},[r("el-tree",{ref:"menuPermissionTree",attrs:{id:"roleCreateTree",data:e.menuPermission,"node-key":"id","default-checked-keys":e.selectedItemPermissionsElement,"show-checkbox":"","default-expand-all":""}})],1)]),r("FormItem",{attrs:{label:"操作权限"}},[r("CheckboxGroup",{staticStyle:{color:"rgba(255,255,255,1)"},on:{"on-change":e.checkAllGroup},model:{value:e.roleNew.operationPermissionArray,callback:function(t){e.$set(e.roleNew,"operationPermissionArray",t)},expression:"roleNew.operationPermissionArray"}},[r("Checkbox",{attrs:{label:"允许查看",disabled:"",id:"enableWatch"}}),r("Checkbox",{attrs:{label:"允许操作",id:"enableOperation"}})],1)],1),r("div",{staticStyle:{"text-align":"center"}},[r("Button",{staticStyle:{background:"rgba(13,67,111,1)",color:"rgba(199,219,244,1)","margin-left":"60px"},on:{click:e.cancelCreateRole}},[e._v("取消")]),r("Button",{staticStyle:{"margin-left":"60px"},attrs:{type:"primary"},on:{click:function(t){return e.confirmCreateRole("roleNew")}}},[e._v("确定")])],1)],1)],1)],1)],1)],1)],1)],1)},n=[],i=(r("a4d3"),r("e01a"),r("b0c0"),r("d3b7"),r("25f0"),r("b85c")),s=r("53ca"),a=r("4ec3"),l={data:function(){var e=this,t=function(t,r,o){return r?r.length>20?(e.roleNameLength=r.length,o(new Error("角色名称过长,请重新输入!"))):(e.roleNameLength=r.length,void o()):(e.roleNameLength=0,o(new Error("角色名称不能为空!")))},r=function(t,r,o){return r?r.length>50?(e.descriptionLength=r.length,o(new Error("角色描述过长,请重新输入!"))):(e.descriptionLength=r.length,void o()):(e.descriptionLength=0,o(new Error("角色描述不能为空!")))};return{roleNew:{roleName:"",description:"",operationPermissionArray:["允许查看"]},roleNewRule:{roleName:[{required:!0,message:"角色名称不能为空!",trigger:"blur"},{required:!0,validator:t,trigger:"change"}],description:[{required:!0,message:"角色描述不能为空!",trigger:"blur"},{required:!0,validator:r,trigger:"change"}]},menuPermission:[],operationPermissions:0,choosedMenuIds:[],choosedMenuOnlyIds:[],notLeaf:[],selectedItemPermissionsElement:[],roleNameLength:0,descriptionLength:0,base:1,tabHeight:0}},created:function(){this.queryMenuTree()},mounted:function(){this.autoFix()},methods:{autoFix:function(){var e=this;this.getDom(),window.onresize=function(){e.getDom()}},getDom:function(){var e=window.innerWidth,t=window.innerHeight;this.base=(e-160)/864,this.tabHeight=t-130},queryMenuTree:function(){var e=this,t={systemType:2};this.menuPermission=[],a["a"].queryMenuTreeJson(t).then((function(t){var r=t.result;e.menuPermission=[];for(var o=0;o<r.length;o++)e.jsonData(r[o]);e.menuPermission=r}))},jsonData:function(e){if("object"===Object(s["a"])(e)&&e.constructor===Object.prototype.constructor){var t=[];t.push(e)}else t=e;for(var r=0;r<t.length;r++){var o=t[r];0!==o.permissions.length&&this.notLeaf.push(o.id.toString()),o.label=o.name,o.children=o.permissions,o.expand=!0,o.children&&o.children.length>0?this.jsonData(o.children):0===o.parentId&&(o.disabled=!0)}},getUserChoosedMenuInfo:function(){var e=this.$refs.menuPermissionTree.getHalfCheckedNodes(),t=this.$refs.menuPermissionTree.getCheckedNodes();this.choosedMenuIds=[],this.choosedMenuOnlyIds=[];var r,o=Object(i["a"])(e);try{for(o.s();!(r=o.n()).done;){var n=r.value;this.choosedMenuIds.push(n.id.toString()),this.choosedMenuOnlyIds.push(n.permissionId)}}catch(c){o.e(c)}finally{o.f()}var s,a=Object(i["a"])(t);try{for(a.s();!(s=a.n()).done;){var l=s.value;this.choosedMenuIds.push(l.id.toString()),this.choosedMenuOnlyIds.push(l.permissionId)}}catch(c){a.e(c)}finally{a.f()}},checkAllGroup:function(e){2===e.length?this.operationPermissions=1:1===e.length&&(this.operationPermissions=0)},cancelCreateRole:function(){this.roleNameLength=0,this.descriptionLength=0,this.$router.push({name:"system-manage-role"})},confirmCreateRole:function(e){var t=this;this.getUserChoosedMenuInfo(),this.$refs[e].validate((function(e){if(e){var r={roleName:t.roleNew.roleName,roleDescription:t.roleNew.description,permissionIds:t.choosedMenuIds,permissionOnlyIds:t.choosedMenuOnlyIds,operationPermissions:t.operationPermissions};0===t.choosedMenuIds.length||0===t.choosedMenuOnlyIds.length?t.$Message.error("请选择菜单"):a["a"].roleCreateDrbs(r).then((function(e){t.$Message.success("新建角色成功!"),t.choosedMenuIds=[],t.choosedMenuOnlyIds=[],t.operationPermissions=0,t.roleNameLength=0,t.descriptionLength=0,t.$router.push({name:"system-manage-role"})}),(function(e){t.roleNameLength=0,t.descriptionLength=0}))}}))},handleReset:function(e){this.$refs[e].resetFields()}}},c=l,h=(r("be0f"),r("2877")),d=Object(h["a"])(c,o,n,!1,null,null,null);t["default"]=d.exports},be0f:function(e,t,r){"use strict";var o=r("2d74"),n=r.n(o);n.a}}]);
//# sourceMappingURL=chunk-f63153a4.7984af0b.js.map