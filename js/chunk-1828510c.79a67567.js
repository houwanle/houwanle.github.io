(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1828510c"],{"3f3f":function(e,t,a){"use strict";a("498a");var r=a("2b0e"),s=(new r["default"],{especilTest:function(e,t,a){t.trim()?a():a(new Error("请输入媒资名称"))},spaceTest:function(e,t,a){t.length!==t.trim().length?a(new Error("输入字符两侧不允许出现空格")):a()}});t["a"]=s},"498a":function(e,t,a){"use strict";var r=a("23e7"),s=a("58a8").trim,i=a("c8d2");r({target:"String",proto:!0,forced:i("trim")},{trim:function(){return s(this)}})},5221:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{width:"100%",height:"38px",background:"rgba(13,67,111,1)","box-shadow":"0px 2px 10px 0px rgba(0, 0, 0, 0.05)","font-size":"14px","font-family":"Microsoft YaHei","font-weight":"400",color:"rgba(255,255,255,1)","padding-left":"24px","line-height":"38px"}},[e._v(" 操作员管理 ")]),a("Row",[a("Col",{attrs:{span:"24"}},[a("Card",{staticStyle:{margin:"10px"}},[a("Row",[a("Col",{staticStyle:{display:"flex","justify-content":"flex-start"}},[a("div",[a("span",{staticStyle:{"margin-left":"28px","font-size":"14px","font-family":"Microsoft YaHei","font-weight":"400",color:"rgba(255,255,255,1)"}},[e._v("名称：")]),a("Input",{style:{width:200*e.base+"px"},attrs:{icon:"ios-close-empty",placeholder:"请输入名称"},on:{"on-click":e.handleCancel3},model:{value:e.searchConName3,callback:function(t){e.searchConName3=t},expression:"searchConName3"}})],1),a("div",{staticStyle:{"margin-left":"50px"}},[a("span",{staticStyle:{"font-size":"14px","font-family":"Microsoft YaHei","font-weight":"400",color:"rgba(255,255,255,1)"}},[e._v("状态：")]),a("Select",{style:{width:200*e.base+"px"},model:{value:e.isEnabled,callback:function(t){e.isEnabled=t},expression:"isEnabled"}},e._l(e.stateList,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1),a("div",[a("span",{staticStyle:{margin:"0 10px"},on:{click:function(t){return e.changePage(1)}}},[a("Button",{staticClass:"btn-gray",attrs:{type:"primary"}},[e._v("查询")])],1)])])],1)],1),a("Card",{staticClass:"card-after",staticStyle:{margin:"10px"}},[a("div",{staticStyle:{display:"flex","justify-content":"flex-end"}},[a("Button",{staticStyle:{background:"rgba(13,67,111,1)",color:"rgba(199,219,244,1)"},attrs:{disabled:e.isGray},on:{click:e.adminCreate}},[e._v("新建")]),a("Button",{staticClass:"btn-right",staticStyle:{color:"rgba(245,108,108,1)",background:"rgba(13,67,111,1)","border-color":"rgba(245,108,108,1)"},attrs:{disabled:e.isGray},on:{click:e.stop}},[e._v("禁用")]),a("Button",{staticClass:"btn-right",staticStyle:{background:"rgba(13,67,111,1)",color:"rgba(199,219,244,1)"},attrs:{disabled:e.isGray},on:{click:e.start}},[e._v("启用")]),0!==e.selectarr.length?a("Poptip",{attrs:{confirm:"",title:"确定删除？","ok-text":"删除"},on:{"on-ok":e.ok,"on-cancel":e.cancel}},[a("Button",{staticClass:"btn-gray btn-right",staticStyle:{color:"rgba(245,108,108,1)",background:"rgba(13,67,111,1)","border-color":"rgba(245,108,108,1)"},attrs:{disabled:e.isGray}},[e._v("删除")])],1):a("Button",{staticClass:"btn-right",staticStyle:{color:"rgba(245,108,108,1)",background:"rgba(13,67,111,1)","border-color":"rgba(245,108,108,1)"},attrs:{disabled:e.isGray},on:{click:e.ok}},[e._v("删除")])],1),a("Row",[a("Col",[a("Modal",{attrs:{"class-name":"passwordReset","mask-closable":!1,width:"640"},model:{value:e.modal6,callback:function(t){e.modal6=t},expression:"modal6"}},[a("p",{staticStyle:{color:"#484f5f","text-align":"left"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"search"}}),a("span",[e._v("密码重置")])],1),a("Form",{ref:"formModification2",staticStyle:{"margin-top":"35px"},attrs:{model:e.formModification2,rules:e.ruleValidate,"label-position":"right","label-width":140}},[a("Row",{attrs:{type:"flex",justify:"center",align:"middle",gutter:16}},[a("Col",{attrs:{span:"22"}},[a("FormItem",{attrs:{label:"密码：",prop:"newPassword2"}},[a("Input",{staticStyle:{width:"351px",height:"32px"},attrs:{type:"password"},model:{value:e.formModification2.newPassword2,callback:function(t){e.$set(e.formModification2,"newPassword2",t)},expression:"formModification2.newPassword2"}}),a("span",{staticStyle:{color:"rgba(175,188,204,1)","margin-left":"10px"}},[e._v(e._s(e.newPassword2Length)+"/20")])],1)],1)],1),a("Row",{attrs:{type:"flex",justify:"center",align:"middle",gutter:16}},[a("Col",{attrs:{span:"22"}},[a("FormItem",{attrs:{label:"确认密码：",prop:"newPasswordAg2"}},[a("Input",{staticStyle:{width:"351px",height:"32px"},attrs:{type:"password"},model:{value:e.formModification2.newPasswordAg2,callback:function(t){e.$set(e.formModification2,"newPasswordAg2",t)},expression:"formModification2.newPasswordAg2"}}),a("span",{staticStyle:{color:"rgba(175,188,204,1)","margin-left":"10px"}},[e._v(e._s(e.newPasswordAg2Length)+"/20")])],1)],1)],1)],1),a("div",{staticStyle:{"text-align":"center","margin-bottom":"20px"},attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticStyle:{background:"rgba(13,67,111,1)",color:"rgba(199,219,244,1)"},on:{click:function(t){e.modal6=!1}}},[e._v("取消")]),a("Button",{staticStyle:{"margin-left":"49px"},attrs:{type:"primary"},on:{click:function(t){return e.submitInfo3()}}},[e._v("确定")])],1)],1),a("Modal",{attrs:{"mask-closable":!1,width:1==e.currentTabPane?950:500,height:"600"},model:{value:e.modal7,callback:function(t){e.modal7=t},expression:"modal7"}},[a("Form",[a("Tabs",{staticStyle:{height:"475px"},attrs:{id:"tabsChange"},model:{value:e.currentTabPane,callback:function(t){e.currentTabPane=t},expression:"currentTabPane"}},[a("TabPane",{attrs:{label:"录像授权观看",name:"1"}},[a("FormItem",[a("shuttle-box",{ref:"videoShuttleBox"})],1)],1),a("TabPane",{attrs:{label:"直播授权观看",name:"2"}},[a("div",{staticStyle:{"margin-top":"10px",border:"1px solid rgba(87,111,140,1)",height:"413px",overflow:"auto",background:"rgba(22,60,105,1)"}},[a("Tree",{ref:"livePermissionTree",attrs:{data:e.livePermissionArray,"show-checkbox":""}})],1)])],1)],1),a("div",{staticStyle:{"margin-right":"120px"},attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticStyle:{background:"rgba(13,67,111,1)",color:"rgba(199,219,244,1)","margin-right":"30px"},on:{click:e.cancelPermission}},[e._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:e.confirmPermission}},[e._v("确定授权")])],1)],1)],1),a("div",{staticStyle:{"margin-top":"10px"}},[a("Table",{ref:"selection",attrs:{height:e.tabHeight,loading:e.loading,columns:e.columns1,data:e.historyData},on:{"on-selection-change":e.selectobj}}),a("Page",{staticClass:"card-after",staticStyle:{margin:"20px 0","text-align":"right"},attrs:{current:e.pageNo,total:e.pagetotal,"show-sizer":"","show-elevator":"","show-total":"",placement:"top"},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)],1)],1)],1)],1)],1)},s=[],i=(a("4160"),a("d3b7"),a("25f0"),a("159b"),a("b85c")),n=a("4ec3"),o=a("3f3f"),l=a("12a9"),c={name:"AdminTable",components:{shuttleBox:l["default"]},data:function(){var e=this,t=o["a"].spaceTest,a=function(t,a,r){if(e.formCreated.newPassword1!==e.formCreated.newPasswordAg1)return r(new Error("输入的两次密码不一致，请重新输入"));r()},r=function(t,a,r){if(e.formModification2.newPassword2!==e.formModification2.newPasswordAg2)return r(new Error("输入的两次密码不一致，请重新输入"));r()},s=function(t,a,r){""===a?(e.newPassword2Length=0,r(new Error("密码不能为空!"))):a.length>20?(e.newPassword2Length=a.length,r(new Error("密码过长,请重新输入!"))):(e.newPassword2Length=a.length,r())},i=function(t,a,r){""===a?(e.newPasswordAg2Length=0,r(new Error("确认密码不能为空!"))):a.length>20?(e.newPasswordAg2Length=a.length,r(new Error("确认密码过长,请重新输入!"))):(e.newPasswordAg2Length=a.length,r())};return{currentTabPane:"1",formCreated:{newName1:"",newPassword1:"",newPasswordAg1:"",newPhone1:"",newEmail1:""},formModification:{newPhone:"",newEmail:""},formModification2:{newPassword2:"",newPasswordAg2:""},ruleValidate:{newName1:[{required:!0,message:"请输入操作员名称",trigger:"blur"},{validator:t,trigger:"blur"},{max:20,message:"输入字符长度不允许超出20",trigger:"blur"}],newPassword1:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^\S+$/,message:"请输入长度4 - 20 的英文、 数字、 特殊字符",trigger:"blur"},{min:4,message:"输入字符长度不允许小于4",trigger:"blur"},{max:20,message:"输入字符长度不允许超出20",trigger:"blur"}],newPasswordAg1:[{required:!0,trigger:"blur",message:"请输入重复密码"},{max:20,message:"输入字符长度不允许超出20",trigger:"blur"},{validator:a}],newPhone1:[{required:!1,trigger:"blur"},{validator:t,trigger:"blur"},{max:20,message:"输入字符长度不允许超出20",trigger:"blur"}],newEmail1:[{required:!1,trigger:"blur"},{pattern:/^([0-9A-Za-z\-_\.]+)@([0-9a-z]+\.[a-z]{2,3}(\.[a-z]{2})?)$/g,message:"请输入有效的邮箱",trigger:"blur"},{max:200,message:"输入字符长度不允许超出200",trigger:"blur"}],newPhone:[{required:!1,trigger:"blur"},{validator:t,trigger:"blur"},{max:20,message:"输入字符长度不允许超出20",trigger:"blur"}],newEmail:[{required:!1,trigger:"blur"},{pattern:/^([0-9A-Za-z\-_\.]+)@([0-9a-z]+\.[a-z]{2,3}(\.[a-z]{2})?)$/g,message:"请输入有效的邮箱",trigger:"blur"},{max:200,message:"输入字符长度不允许超出200",trigger:"blur"}],newPassword2:[{required:!0,validator:s,trigger:"change"},{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^(?![a-zA-z]+$)(?!\d+$)(?![!@#$&*]+$)[a-zA-Z\d!@#$&*]+$/,message:"请输入长度4-20位英文、 数字、特殊字符（!，@，#，$，&，*）任意两种组合",trigger:"blur"},{min:4,message:"输入字符长度不允许小于4",trigger:"blur"},{max:20,message:"输入字符长度不允许超出20",trigger:"blur"}],newPasswordAg2:[{required:!0,validator:i,trigger:"change"},{required:!0,trigger:"blur",message:"请输入重复密码"},{max:20,message:"输入字符长度不允许超出20",trigger:"blur"},{validator:r,trigger:"blur"}]},stateList:[{value:1,label:"已启用"},{value:0,label:"未启用"},{value:"all",label:"全部"}],channelIds:[],channelName:"",choosedProgramData:[],livePermissionArray:[{title:"",expand:"",checked:"",disabled:"",category_id:"",children:[{title:"",expand:"",checked:"",channel_id:"",is_auth:""}]}],show:!0,res1:[],searchConName3:"",searchConName2:"",searchConName1:"",searchDescription1:"",searchDescription2:"",columns1:[{type:"selection",width:34},{key:"username",title:"操作员名称",minWidth:110},{key:"roleName",title:"角色",minWidth:108},{key:"loginIp",title:"最后登录IP",minWidth:140},{key:"loginDate",title:"最后登录时间",minWidth:166},{key:"login_status",title:"登录状态",minWidth:100},{key:"isEnabled",title:"启用状态",minWidth:100},{key:"handle",title:"操作",align:"center",fixed:"right",width:184}],columns2:[{type:"selection",width:60,align:"center"},{title:"角色名称",key:"name",align:"center"},{title:"角色描述",key:"description",align:"center"}],isEnabled:"all",isEnabledBoolean:!0,roleTable:[],roleTable2:[],selectRole:[],selectRoleId:[],role:[],selectarr:[],dataCount:0,historyData:[],historyData2:[],current:1,modal1:!1,modal2:!1,modal3:!1,modal4:!1,modal5:!1,modal6:!1,modal7:!1,loadingTree:!0,tree:[],selectedItemPermissionsElement:[],notLeaf:[],selectedItem:[],permissionIds:[],permissionNewIds:[],oldId:"",oldName:"",oldRole:[],oldRoleId:[],oldState:"",oldPassword:"",oldPasswordAg:"",oldTime:"",oldLasttime:"",oldIp:"",idsList:[],userIdsList:[],userId:"",currentRow:[],loading:!1,loading2:!1,roleTableloading:!1,roleSearchbtn:!1,pagetotal:10,pageNo:1,pageSize:10,isGray:!1,newPassword2Length:0,newPasswordAg2Length:0,base:1,tabHeight:0}},created:function(){var e=this;this.isGray=1!=JSON.parse(localStorage.getItem("loginRes")).user.operationPermissions,this.handleSearch1(),this.init(),this.$bus.$on("handlerChange",(function(t){e.handleSearch1()}))},mounted:function(){this.autoFix()},beforeDestroy:function(){this.$bus.$off("handlerChange")},methods:{autoFix:function(){var e=this;this.getDom(),window.onresize=function(){e.getDom()}},getDom:function(){var e=window.innerWidth,t=window.innerHeight;this.base=(e-160)/864,this.tabHeight=t-350},adminCreate:function(){this.$router.push({name:"admin-create"})},updateAdminInfo:function(e){e&&sessionStorage.setItem("operatorParam",JSON.stringify(e)),this.$router.push({name:"admin-update"})},init:function(){var e=this,t=this;this.columns1.forEach((function(a){"handle"===a.key&&(a.render=function(a,r){return a("p",[a("span",{props:{type:"text"},style:{marginRight:"4px",color:e.isGray?"gray":"#02E8FF",cursor:e.isGray?"not-allowed":"pointer"},on:{click:function(){if(t.isGray)return!1;t.updateAdminInfo(r.row)}}},"修改"),a("span",{props:{type:"text"},style:{marginRight:"4px",color:e.isGray?"gray":"#02E8FF",cursor:e.isGray?"not-allowed":"pointer"},on:{click:function(){if(t.isGray)return!1;t.handleReset("formModification2"),t.newPassword2Length=0,t.newPasswordAg2Length=0,t.modal6=!0,t.userId=r.row.userId}}},"密码重置"),a("span",{props:{type:"text"},style:{color:e.isGray?"gray":"#02E8FF",cursor:e.isGray?"not-allowed":"pointer"},on:{click:function(){if(t.isGray)return!1;t.modal7=!0,t.currentRow=r.row,t.currentTabPane="1",t.queryLivePermissionList(r.row.userId),t.cancelUserProgram(r.row.userId)}}},"授权观看")])})}))},queryLivePermissionList:function(e){var t=this;if(e){var a={user_id:e};this.livePermissionArray=[],n["a"].queryLivePermissionJson(a).then((function(e){if(e.result){var a,r=Object(i["a"])(e.result);try{for(r.s();!(a=r.n()).done;){var s=a.value,n={};n.title=s.category_name,n.expand=!0,n.category_id=s.category_id,n.children=[];var o,l=Object(i["a"])(s.channels);try{for(l.s();!(o=l.n()).done;){var c=o.value,d={};d.title=c.channel_name,d.expand=!0,d.channel_id=c.channel_id,d.is_auth=c.is_auth,1==c.is_auth&&(d.checked=!0),n.children.push(d)}}catch(g){l.e(g)}finally{l.f()}t.livePermissionArray.push(n)}}catch(g){r.e(g)}finally{r.f()}}}))}},cancelUserProgram:function(e){var t=this;if(e){var a={userId:e};n["a"].cancelUserProgram(a).then((function(e){t.$refs.videoShuttleBox.pageNoLeft=1,t.$refs.videoShuttleBox.pageNoRight=1,t.$refs.videoShuttleBox.videoSearchLeft(t.currentRow.userId),t.$refs.videoShuttleBox.videoSearchRight(t.currentRow.userId)}))}},cancelPermission:function(){if(this.currentRow.userId){var e={userId:this.currentRow.userId};n["a"].cancelUserProgram(e).then((function(e){}))}this.modal7=!1,this.handleSearch1()},confirmPermission:function(){var e=this.$refs.livePermissionTree.getCheckedNodes();this.channelIds=[];var t,a=Object(i["a"])(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;r.channel_id&&this.channelIds.push(r.channel_id)}}catch(s){a.e(s)}finally{a.f()}this.updateChannelAndVideoPermission(),this.handleSearch1()},updateChannelAndVideoPermission:function(){var e=this,t={user_id:this.currentRow.userId,channels:this.channelIds};n["a"].updateUserChannelAuth(t).then((function(t){e.channelIds=[],e.$refs.videoShuttleBox.saveUserProgram(e.currentRow.userId),e.modal7=!1}))},ok:function(){var e=this;if(this.selectarr.length<1)return this.$Message.error("请勾选操作员后，再进行操作"),!1;var t={ids:this.idsList,userIds:this.userIdsList};n["a"].deleteJson(t).then((function(t){if(t.status&&"1222"===t.status)return e.pagetotal-(e.pageNo-1)*e.pageSize===e.selectarr.length&&e.pageNo>1&&e.pageNo--,e.handleSearch1(),!1;e.pagetotal-(e.pageNo-1)*e.pageSize===e.selectarr.length&&e.pageNo>1&&e.pageNo--,e.handleSearch1(),e.$Message.success("操作员删除成功")}),(function(t){e.handleSearch1()}))},cancel:function(){},handleSearch1:function(){var e=this;1===this.isEnabled?this.isEnabledBoolean=!0:0===this.isEnabled?this.isEnabledBoolean=!1:this.isEnabledBoolean="";var t={userName:this.searchConName3,isEnabled:this.isEnabledBoolean,pageNo:this.pageNo,pageSize:this.pageSize};this.loading=!0,n["a"].searchJson(t).then((function(t){if(t.result&&0!=t.result.length){var a,r=Object(i["a"])(t.result);try{for(r.s();!(a=r.n()).done;){var s=a.value;1==s.roleStatus&&(s.roleName="")}}catch(o){r.e(o)}finally{r.f()}}for(var n in e.historyData=t.result,0===e.historyData.length&&e.pageNo>1&&(e.pageNo--,e.handleSearch1()),e.historyData)!1===e.historyData[n].isEnabled?e.historyData[n].isEnabled="未启用":e.historyData[n].isEnabled="已启用",e.historyData[n].login_status=1===e.historyData[n].loginStatus?"在线":"离线";e.pagetotal=t.count,e.pageNo=t.pageNo,e.pageSize=t.pageSize,e.loading=!1,e.selectarr=[],e.idsList=[],e.userIdsList=[]}),(function(t){e.loading=!1}))},handleCancel3:function(){this.searchConName3="",this.resetPage(),this.handleSearch1()},resetPage:function(){this.pageNo=1},pagesize:function(e){this.pageSize=e},handleReset:function(e){this.$refs[e].resetFields()},submitInfo3:function(){var e=this;this.$refs.formModification2.validate((function(t){if(t){var a={userId:e.userId,newPassword:btoa(encodeURI(e.formModification2.newPassword2))};e.loading=!0,n["a"].modifyUserPassword(a).then((function(t){if(t.status&&"1222"===t.status)return e.modal6=!1,e.handleSearch1(),!1;e.$Message.success("密码重置成功"),e.handleReset("formModification2"),e.loading=!1,e.modal6=!1,e.handleSearch1()}),(function(t){e.loading=!1,e.modal6=!1,e.handleSearch1()}))}else e.$Message.error("请输入符合规则的内容")}))},selectobj:function(e){for(var t in this.selectarr=[],this.idsList=[],this.userIdsList=[],e)this.selectionObj={},this.selectionObj.id=e[t].id.toString(),this.selectionObj.isEnabled=e[t].isEnabled,this.selectionObj.userId=e[t].userId,this.selectarr.push(this.selectionObj),this.idsList.push(e[t].id.toString()),this.userIdsList.push(e[t].userId.toString())},createdTime:function(){var e=new Date,t="-",a=":",r=e.getMonth()+1,s=e.getDate();r>=1&&r<=9&&(r="0"+r),s>=0&&s<=9&&(s="0"+s);var i=e.getFullYear()+t+r+t+s+" "+e.getHours()+a+e.getMinutes()+a+e.getSeconds();return i},stop:function(){var e=this;if(this.selectarr.length<1)return this.$Message.error("请勾选操作员后，再进行操作"),!1;for(var t in this.selectarr)if("未启用"===this.selectarr[t].isEnabled)return this.$Message.error("当前勾选的操作员包含未启用操作员，不允许禁用操作"),!1;var a={ids:this.idsList,userIds:this.userIdsList};n["a"].stopJson(a).then((function(t){if(t.status&&"1222"===t.status)return e.pagetotal-(e.pageNo-1)*e.pageSize===e.selectarr.length&&e.pageNo>1&&e.pageNo--,e.handleSearch1(),!1;e.$Message.success("操作员禁用成功"),e.handleSearch1()}),(function(t){e.handleSearch1()}))},start:function(){var e=this;if(this.selectarr.length<1)return this.$Message.error("请勾选操作员后，再进行操作"),!1;for(var t in this.selectarr)if("已启用"===this.selectarr[t].isEnabled)return this.$Message.error("当前勾选的操作员含有已启用操作员，不允许启用操作"),!1;var a={ids:this.idsList,userIds:this.userIdsList};n["a"].startJson(a).then((function(t){if(t.status&&"1222"===t.status)return e.pagetotal-(e.pageNo-1)*e.pageSize===e.selectarr.length&&e.pageNo>1&&e.pageNo--,e.handleSearch1(),!1;e.$Message.success("操作员启用成功"),e.handleSearch1()}),(function(t){e.handleSearch1()}))},validate:function(e){var t=/^[0-9]*$/;return t.test(e)},changePageSize:function(e){this.pageSize=e,1===this.pageNo&&this.handleSearch1()},changePage:function(e){this.pageNo=e,this.handleSearch1()}}},d=c,g=(a("cd336"),a("2877")),h=Object(g["a"])(d,r,s,!1,null,null,null);t["default"]=h.exports},"94f9":function(e,t,a){},c8d2:function(e,t,a){var r=a("d039"),s=a("5899"),i="​᠎";e.exports=function(e){return r((function(){return!!s[e]()||i[e]()!=i||s[e].name!==e}))}},cd336:function(e,t,a){"use strict";var r=a("94f9"),s=a.n(r);s.a}}]);
//# sourceMappingURL=chunk-1828510c.79a67567.js.map