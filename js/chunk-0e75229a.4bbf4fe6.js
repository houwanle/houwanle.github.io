(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e75229a"],{"4ba1":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Row",[a("Col",{attrs:{span:"24"}},[a("Card",[a("p",{attrs:{slot:"title"},slot:"title"},[a("Icon",{attrs:{type:"grid"}}),e._v(" 操作员查询 ")],1),a("Row",[a("Col",{staticStyle:{display:"flex","justify-content":"flex-start"}},[a("div",[e._v(" 名称： "),a("Input",{staticStyle:{width:"200px"},attrs:{icon:"ios-close-empty",placeholder:"请输入名称"},on:{"on-click":e.handleCancel3},model:{value:e.searchConName3,callback:function(t){e.searchConName3=t},expression:"searchConName3"}})],1),a("div",{staticStyle:{"margin-left":"50px"}},[e._v(" 状态： "),a("Select",{staticStyle:{width:"200px"},model:{value:e.isEnabled,callback:function(t){e.isEnabled=t},expression:"isEnabled"}},e._l(e.stateList,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1),a("div",[a("span",{staticStyle:{margin:"0 10px"},on:{click:function(t){return e.changePage(1)}}},[a("Button",{staticClass:"btn-gray",attrs:{type:"primary",icon:"search"}},[e._v("查询")])],1)])])],1)],1),a("Card",{staticClass:"card-after"},[a("Row",[a("Col",[a("Modal",{attrs:{"class-name":"vertical-center-modal","mask-closable":!1,"ok-text":"提交","cancel-text":"关闭",closable:!1,width:"655"},model:{value:e.modal3,callback:function(t){e.modal3=t},expression:"modal3"}},[a("p",{staticStyle:{color:"#484f5f","text-align":"left"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"navicon-round"}}),a("span",[e._v("操作员详情")])],1),a("Row",{attrs:{type:"flex",justify:"center",align:"middle",gutter:16}},[a("Col",{staticStyle:{"text-align":"right"},attrs:{span:"4"}},[e._v("操作员ID：")]),a("Col",{attrs:{span:"8"}},[a("Input",{attrs:{disabled:""},model:{value:e.oldId,callback:function(t){e.oldId=t},expression:"oldId"}})],1),a("Col",{staticStyle:{"text-align":"right"},attrs:{span:"4"}},[e._v("操作员名称：")]),a("Col",{attrs:{span:"8"}},[a("Input",{attrs:{disabled:""},model:{value:e.oldName,callback:function(t){e.oldName=t},expression:"oldName"}})],1)],1),a("br"),a("Row",{attrs:{type:"flex",justify:"center",align:"middle",gutter:16}},[a("Col",{staticStyle:{"text-align":"right"},attrs:{span:"4"}},[e._v("角色名称：")]),a("Col",{attrs:{span:"8"}},[a("div",{staticClass:"oldRoleStringBox"},[e._v(e._s(e.oldRoleString))])]),a("Col",{staticStyle:{"text-align":"right"},attrs:{span:"4"}},[e._v('"状态："')]),a("Col",{attrs:{span:"8"}},[a("Input",{attrs:{disabled:""},model:{value:e.oldState,callback:function(t){e.oldState=t},expression:"oldState"}})],1)],1),a("br"),a("Row",{attrs:{type:"flex",justify:"center",align:"middle",gutter:16}},[a("Col",{staticStyle:{"text-align":"right"},attrs:{span:"4"}},[e._v("手机：")]),a("Col",{attrs:{span:"8"}},[a("Input",{attrs:{disabled:""},model:{value:e.formModification.newPhone,callback:function(t){e.$set(e.formModification,"newPhone",t)},expression:"formModification.newPhone"}})],1),a("Col",{staticStyle:{"text-align":"right"},attrs:{span:"4"}},[e._v("邮箱：")]),a("Col",{attrs:{span:"8"}},[a("Input",{attrs:{disabled:""},model:{value:e.formModification.newEmail,callback:function(t){e.$set(e.formModification,"newEmail",t)},expression:"formModification.newEmail"}})],1)],1),a("br"),a("Row",{attrs:{type:"flex",justify:"center",align:"middle",gutter:16}},[a("Col",{staticStyle:{"text-align":"right"},attrs:{span:"4"}},[e._v("创建日期：")]),a("Col",{attrs:{span:"8"}},[a("Input",{attrs:{disabled:""},model:{value:e.oldTime,callback:function(t){e.oldTime=t},expression:"oldTime"}})],1),a("Col",{staticStyle:{"text-align":"right"},attrs:{span:"4"}},[e._v("最后登陆日期：")]),a("Col",{attrs:{span:"8"}},[a("Input",{attrs:{disabled:""},model:{value:e.oldLasttime,callback:function(t){e.oldLasttime=t},expression:"oldLasttime"}})],1)],1),a("br"),a("Row",{attrs:{type:"flex",justify:"center",align:"middle",gutter:16}},[a("Col",{staticStyle:{"text-align":"right"},attrs:{span:"4"}},[e._v("最后登陆IP：")]),a("Col",{attrs:{span:"8"}},[a("Input",{attrs:{disabled:""},model:{value:e.oldIp,callback:function(t){e.oldIp=t},expression:"oldIp"}})],1),a("Col",{staticStyle:{"text-align":"right"},attrs:{span:"4"}}),a("Col",{attrs:{span:"8"}})],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"default"},on:{click:e.cancelModal}},[e._v("关闭")])],1)],1),a("Modal",{staticClass:"relationTree",attrs:{"class-name":"vertical-center-modal",closable:!1,"mask-closable":!1},model:{value:e.modal7,callback:function(t){e.modal7=t},expression:"modal7"}},[a("p",{attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"key"}}),e._v(" 数据权限分配 ")],1),a("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"flex-start","padding-bottom":"10px"}},[a("p",{staticStyle:{"padding-right":"40px",width:"50%","word-wrap":"break-word","word-break":"normal"}},[e._v("操作员名称："+e._s(e.oldName)+" ")])]),a("Scroll",[a("el-tree",{ref:"eltree",attrs:{data:e.tree,"node-key":"id","default-checked-keys":e.selectedItemPermissionsElement,"show-checkbox":"","default-expand-all":""}}),e.loadingTree?a("Spin",{attrs:{fix:""}}):e._e()],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:e.updateInfo1}},[e._v("确定")]),a("Button",{attrs:{type:"default"},on:{click:e.cancelModal}},[e._v("取消")])],1)],1)],1),a("Table",{ref:"selection",attrs:{border:"",loading:e.loading,columns:e.columns1,data:e.historyData},on:{"on-selection-change":e.selectobj}}),a("Page",{staticClass:"card-after",staticStyle:{marginBottom:"50px","text-align":"right"},attrs:{current:e.pageNo,total:e.pagetotal,"show-sizer":"","show-elevator":"","show-total":"",placement:"top"},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)],1)],1)],1)],1)},i=[],l=(a("4de4"),a("4160"),a("c975"),a("a434"),a("b0c0"),a("d3b7"),a("25f0"),a("159b"),a("53ca")),o=a("b85c"),n=a("4ec3"),r={name:"AdminTable",data:function(){return{formCreated:{newName1:"",newPassword1:"",newPasswordAg1:"",newPhone1:"",newEmail1:""},formModification:{newPhone:"",newEmail:""},formModification2:{newPassword2:"",newPasswordAg2:""},ruleValidate:{newPhone:[{required:!1,trigger:"blur"},{pattern:/^(0|86|17951)?(13[0-9]|15[0-9]|17[0-9]|18[0-9]|14[0-9])[0-9]{8}$/,message:this.$t("admin_manage.validPhoneNumber"),trigger:"blur"},{max:20,message:"输入字符长度不允许超出20",trigger:"blur"}],newEmail:[{required:!1,trigger:"blur"},{pattern:/^([0-9A-Za-z\-_\.]+)@([0-9a-z]+\.[a-z]{2,3}(\.[a-z]{2})?)$/g,message:"请输入有效的邮箱",trigger:"blur"},{max:200,message:"输入字符长度不允许超出200",trigger:"blur"}]},stateList:[{value:1,label:"已启用"},{value:0,label:"未启用"},{value:"all",label:"全部"}],show:!0,res1:[],searchConName3:"",searchConName2:"",searchConName1:"",searchDescription1:"",searchDescription2:"",columns1:[{type:"selection",width:70,align:"center"},{key:"username",title:"操作员名称",align:"center"},{key:"loginIp",title:"最后登陆IP",align:"center"},{key:"loginDate",title:"最后登陆时间",align:"center"},{key:"isEnabled",title:"是否启用",align:"center"},{key:"handle",title:"操作",align:"center"}],columns2:[{type:"selection",width:60,align:"center"},{title:"角色名称",key:"name",align:"center"},{title:"角色描述",key:"description",align:"center"}],isEnabled:"",isEnabledBoolean:!0,roleTable:[],roleTable2:[],selectRole:[],selectRoleId:[],role:[],selectarr:[],dataCount:0,historyData:[],historyData2:[],current:1,modal1:!1,modal2:!1,modal3:!1,modal4:!1,modal5:!1,modal6:!1,modal7:!1,loadingTree:!0,tree:[],selectedItemPermissionsElement:[],notLeaf:[],selectedItem:[],permissionIds:[],permissionNewIds:[],oldId:"",oldName:"",oldRole:[],oldRoleId:[],oldState:"",oldPassword:"",oldPasswordAg:"",oldTime:"",oldLasttime:"",oldIp:"",idsList:[],userIdsList:[],userId:"",loading:!1,loading2:!1,roleTableloading:!1,roleSearchbtn:!1,oldRoleString:"",tempID:"",pagetotal:10,pageNo:1,pageSize:10}},created:function(){this.handleSearch1(),this.rolesJson(),this.init()},mounted:function(){},methods:{init:function(){var e=this;this.columns1.forEach((function(t){"handle"===t.key&&(t.render=function(t,a){return t("p",[t("Button",{props:{type:"text"},style:{marginRight:"0",color:"#11a0f8"},on:{click:function(){e.updateInfo(a.row.id,a.row.userId)}}},"详情"),t("Button",{props:{type:"text"},style:{marginRight:"0",color:"#11a0f8"},on:{click:function(){e.showModal(),e.updateInfo2(a.row),e.generalLocationByUser()}}},"赋数据权限")])})}))},handleSelectAll:function(e){this.$refs.selection2.selectAll(e)},handleClose1:function(e,t){var a=this.selectRole.indexOf(t);this.selectRole.splice(a,1),this.selectRoleId.splice(a,1)},handleClose2:function(e,t){var a=this.oldRole.indexOf(t);this.oldRole.splice(a,1),this.oldRoleId.splice(a,1)},search:function(e,t){var a=e,s=e,i=function(e){t[e].length>0&&(a=s.filter((function(a){return a[e].indexOf(t[e])>-1})),s=a)};for(var l in t)i(l);return a},handleSearch1:function(){var e=this;1===this.isEnabled?this.isEnabledBoolean=!0:0===this.isEnabled?this.isEnabledBoolean=!1:this.isEnabledBoolean="";var t={username:this.searchConName3,isEnabled:this.isEnabledBoolean,pageNo:this.pageNo,pageSize:this.pageSize};this.loading=!0,n["a"].searchJson(t).then((function(t){for(var a in e.historyData=t.result,0===e.historyData.length&&e.pageNo>1&&(e.pageNo--,e.handleSearch1()),e.historyData)!1===e.historyData[a].isEnabled?e.historyData[a].isEnabled="未启用":e.historyData[a].isEnabled="已启用";e.pagetotal=t.count,e.pageNo=t.pageNo,e.pageSize=t.pageSize,e.loading=!1,e.selectarr=[],e.idsList=[],e.userIdsList=[]}),(function(t){e.loading=!1}))},handleCancel3:function(){this.searchConName3="",this.handleSearch1()},pagesize:function(e){this.pageSize=e},handleReset:function(e){this.$refs[e].resetFields()},updateInfo:function(e,t){var a=this,s={id:e,userId:t};this.loading2=!0,n["a"].specificJson(s).then((function(e){if(e.status&&"1222"===e.status)return a.handleSearch1(),!1;for(var t in a.modal3=!0,a.oldRole=[],a.oldRoleId=[],a.oldRoleString="",!1===e.result.isEnabled?e.result.isEnabled="未启用":e.result.isEnabled="已启用",a.oldId=e.result.id,a.oldName=e.result.name,e.result.roles)a.oldRole.push(e.result.roles[t].roleName),a.oldRoleId.push(e.result.roles[t].roleId);for(var s in a.oldRole)a.oldRoleString+=a.oldRole[s]+",";a.oldState=e.result.isEnabled,a.formModification.newPhone=e.result.phone,a.formModification.newEmail=e.result.email,a.oldTime=e.result.createDate,a.oldLasttime=e.result.loginDate,a.oldIp=e.result.loginIp,a.loading2=!1}),(function(e){a.loading2=!1}))},selectobj:function(e){for(var t in this.selectarr=[],this.idsList=[],this.userIdsList=[],e)this.selectionObj={},this.selectionObj.id=e[t].id.toString(),this.selectionObj.isEnabled=e[t].isEnabled,this.selectionObj.userId=e[t].userId,this.selectarr.push(this.selectionObj),this.idsList.push(e[t].id.toString()),this.userIdsList.push(e[t].userId.toString())},cancelModal:function(){this.modal1=!1,this.modal2=!1,this.modal3=!1,this.modal4=!1,this.modal5=!1,this.modal6=!1,this.modal7=!1,this.searchConName1="",this.searchConName2="",this.searchDescription1="",this.searchDescription2="",this.selectRole=[],this.selectRoleId=[],this.oldRole=[]},createdTime:function(){var e=new Date,t="-",a=":",s=e.getMonth()+1,i=e.getDate();s>=1&&s<=9&&(s="0"+s),i>=0&&i<=9&&(i="0"+i);var l=e.getFullYear()+t+s+t+i+" "+e.getHours()+a+e.getMinutes()+a+e.getSeconds();return l},checkList:function(){for(var e in this.roleTable){var t=parseInt(this.roleTable[e].id);for(var a in this.$set(this.roleTable[e],"_checked",!1),this.selectRoleId)t===parseInt(this.selectRoleId[a])&&this.$set(this.roleTable[e],"_checked",!0)}},checkList2:function(){for(var e in this.roleTable2){var t=parseInt(this.roleTable2[e].id);for(var a in this.$set(this.roleTable2[e],"_checked",!1),this.oldRoleId)t===parseInt(this.oldRoleId[a])&&this.$set(this.roleTable2[e],"_checked",!0)}},stop:function(){var e=this;if(this.selectarr.length<1)return this.$Message.error("请勾选操作员后，再进行操作"),!1;for(var t in this.selectarr)if("未启用"===this.selectarr[t].isEnabled)return this.$Message.error("当前勾选的操作员包含未启用操作员，不允许禁用操作"),!1;var a={ids:this.idsList,userIds:this.userIdsList};n["a"].stopJson(a).then((function(t){if(t.status&&"1222"===t.status)return e.pagetotal-(e.pageNo-1)*e.pageSize===e.selectarr.length&&e.pageNo>1&&e.pageNo--,e.handleSearch1(),!1;e.$Message.success("操作员禁用成功"),e.handleSearch1()}),(function(t){e.handleSearch1()}))},start:function(){var e=this;if(this.selectarr.length<1)return this.$Message.error("请勾选操作员后，再进行操作"),!1;for(var t in this.selectarr)if("已启用"===this.selectarr[t].isEnabled)return this.$Message.error("当前勾选的操作员含有已启用操作员，不允许启用操作"),!1;var a={ids:this.idsList,userIds:this.userIdsList};n["a"].startJson(a).then((function(t){if(t.status&&"1222"===t.status)return e.pagetotal-(e.pageNo-1)*e.pageSize===e.selectarr.length&&e.pageNo>1&&e.pageNo--,e.handleSearch1(),!1;e.$Message.success("操作员启用成功"),e.handleSearch1()}),(function(t){e.handleSearch1()}))},validate:function(e){var t=/^[0-9]*$/;return t.test(e)},rolesJson:function(){var e=this,t={roleName:this.searchConName2,description:this.searchDescription2,pageNo:1,pageSize:100};this.roleSearchbtn=!0,this.roleTableloading=!0,n["a"].rolesJson(t).then((function(t){e.roleTable2=t.result,e.checkList2()})),setTimeout((function(){e.roleSearchbtn=!1,e.roleTableloading=!1}),500)},rolesJsonNew:function(){var e=this,t={roleName:this.searchConName1,description:this.searchDescription1,pageNo:1,pageSize:100};this.roleSearchbtn=!0,this.roleTableloading=!0,n["a"].rolesJson(t).then((function(t){e.roleTable=t.result,e.checkList()})),setTimeout((function(){e.roleSearchbtn=!1,e.roleTableloading=!1}),500)},changePageSize:function(e){this.pageSize=e,1===this.pageNo&&this.handleSearch1()},changePage:function(e){this.pageNo=e,this.handleSearch1()},showModal:function(){this.loadingTree=!0},updateInfo2:function(e){this.selectedItem=e,this.oldName=e.username},generalLocationByUser:function(){var e=this;this.loadingTree=!0;var t={id:this.selectedItem.id,userId:this.selectedItem.userId};n["a"].generalLocationByUser(t).then((function(t){if(t.status&&1222==t.status)return e.handleSearch1(),e.modal7=!1,!1;e.modal7=!0,t=t.result;var a=[];if(t.length>0)for(var s=0;s<t.length;s++)a.push(parseInt(t[s].id));e.selectedItemPermissions=a,e.getTheWholeTree(t)}),(function(t){e.loadingTree=!1}))},getTheWholeTree:function(e){var t=this,a={name:""};n["a"].regionJson(a).then((function(a){a=a.result,t.tree=[];for(var s=0;s<a.length;s++)t.jsonData(a[s]);t.selectedItemPermissionsElement=[];var i,l=Object(o["a"])(e);try{for(l.s();!(i=l.n()).done;){var n=i.value;-1===t.notLeaf.indexOf(n.id)&&t.selectedItemPermissionsElement.push(parseInt(n.id))}}catch(r){l.e(r)}finally{l.f()}t.tree=a,t.loadingTree=!1}),(function(e){t.loadingTree=!1}))},jsonData:function(e){if("object"===Object(l["a"])(e)&&e.constructor===Object.prototype.constructor){var t=[];t.push(e)}else t=e;for(var a=0;a<t.length;a++){var s=t[a];s.label=s.name,s.children=s.permissions,s.expand=!0,s.children&&s.children.length>0?this.jsonData(s.children):0===s.parentId&&(s.disabled=!0)}},updateInfo1:function(){var e=this,t=this.$refs.eltree.getHalfCheckedNodes(),a=this.$refs.eltree.getCheckedNodes();this.modal7=!1,this.permissionIds=[],this.permissionNewIds=[];var s,i=Object(o["a"])(t);try{for(i.s();!(s=i.n()).done;){var l=s.value;this.permissionIds.push(l.id),this.permissionNewIds.push(l.locationId)}}catch(u){i.e(u)}finally{i.f()}var r,d=Object(o["a"])(a);try{for(d.s();!(r=d.n()).done;){var c=r.value;this.permissionIds.push(c.id),this.permissionNewIds.push(c.locationId)}}catch(u){d.e(u)}finally{d.f()}var h={id:this.selectedItem.id,userId:this.selectedItem.userId,locationid:this.permissionIds,boLocationId:this.permissionNewIds};this.loading=!0,n["a"].generalUserLinkLocation(h).then((function(t){e.handleSearch1(),e.loading=!1,e.$Message.success("赋数据权限成功")}),(function(t){e.loading=!1}))}}},d=r,c=(a("c5ab"),a("2877")),h=Object(c["a"])(d,s,i,!1,null,null,null);t["default"]=h.exports},"6cd2":function(e,t,a){},c5ab:function(e,t,a){"use strict";var s=a("6cd2"),i=a.n(s);i.a}}]);
//# sourceMappingURL=chunk-0e75229a.4bbf4fe6.js.map