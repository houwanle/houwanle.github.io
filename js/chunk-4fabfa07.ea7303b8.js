(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4fabfa07"],{3007:function(e,t,r){},"498a":function(e,t,r){"use strict";var a=r("23e7"),n=r("58a8").trim,s=r("c8d2");a({target:"String",proto:!0,forced:s("trim")},{trim:function(){return n(this)}})},b87d:function(e,t,r){"use strict";var a=r("3007"),n=r.n(a);n.a},c8d2:function(e,t,r){var a=r("d039"),n=r("5899"),s="​᠎";e.exports=function(e){return a((function(){return!!n[e]()||s[e]()!=s||n[e].name!==e}))}},eb83:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"monRoot"}},[r("Modal",{attrs:{width:"600",closable:!1,"mask-closable":!1},model:{value:e.dottingModal,callback:function(t){e.dottingModal=t},expression:"dottingModal"}},[r("Form",{ref:"formInline",attrs:{"label-width":120}},[r("FormItem",{attrs:{label:"请输入名称："}},[r("Input",{staticStyle:{width:"200px"},attrs:{size:"small",maxlength:20},model:{value:e.dottingName,callback:function(t){e.dottingName=t},expression:"dottingName"}}),r("span",{staticStyle:{color:"#fff"}},[e._v(e._s(e.dottingName.length)+"/20")]),r("Button",{staticStyle:{"margin-left":"30px"},attrs:{type:"primary",size:"small"},on:{click:e.dottingConfirm}},[e._v("确定")]),r("Button",{staticStyle:{background:"rgba(13,67,111,1)",color:"rgba(199,219,244,1)","margin-left":"10px"},attrs:{size:"small"},on:{click:e.dottingCancel}},[e._v("取消")])],1)],1),r("p",{attrs:{slot:"footer"},slot:"footer"})],1)],1)},n=[],s=(r("498a"),r("b85c")),i=r("4ec3"),o={data:function(){return{dottingName:"",recodePlanConfirmModal:!1,dottingModal:!1,sumaQtPlayer:"",isStart:1,recodeSwitchFlag:!1,receiveObj:{},recordPlayUrlChange:[],playerType:"",playerbaseIndex:0,playerRecIndex:0,isGray:!1}},created:function(){var e=this;this.isGray=1!=JSON.parse(localStorage.getItem("loginRes")).user.operationPermissions,this.$bus.$on("showPlay",(function(t){e.setQmlPlayerProperty(t)})),this.$bus.$on("recodeSwitchFlag",(function(t){e.recodeSwitchFlag=t})),this.$bus.$on("receiveObj",(function(t){e.receiveObj=t})),this.$bus.$on("dottingModal",(function(t){e.dottingModal=t,e.dottingName=""}))},destroyed:function(){this.$bus.$off("showPlayer"),this.$bus.$off("recodeSwitchFlag"),this.$bus.$off("receiveObj"),this.$bus.$off("dottingModal")},mounted:function(){var e=this;console.log(999,this.$sumaQtPlayer),setTimeout((function(){var t=e;t.$sumaQtPlayer}),0)},methods:{getServerTime:function(){var e=this;i["a"].getServerTime({}).then((function(t){var r=t.result.secondTimeStamp;e.setQmlPlayerServerTime(r)}))},recodeConfirm:function(){var e=this;if(this.recodeSwitchFlag){var t={isStartRecord:0,autoRecordPlan:this.isStart,channelIdList:[this.receiveObj.channelId]},r=JSON.parse(sessionStorage.getItem("monitorState"));i["a"].startOrStopRecord(t).then((function(t){e.$Message.success("录制已启动"),e.$emit("changeRecode"),e.recodePlanConfirmModal=!1;var a=[{groupIndex:-2,playerIndex:-2,channelId:"",business:{},player:{isVisible:!0}}];e.setQmlPlayerProperty(a);var n,i=Object(s["a"])(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;(o.playerIndex===e.receiveObj.playerIndex||o.channelId===e.receiveObj.channelId)&&(o.business.isRecording=!0)}}catch(l){i.e(l)}finally{i.f()}e.setQmlPlayerProperty(r),sessionStorage.setItem("monitorState",JSON.stringify(r))}),(function(t){e.setQmlPlayerProperty(r)}))}else{var a={isStartRecord:1,autoRecordPlan:this.isStart,channelIdList:[this.receiveObj.channelId]},n=JSON.parse(sessionStorage.getItem("monitorState"));i["a"].startOrStopRecord(a).then((function(t){e.$Message.success("录制已关闭"),e.$emit("changeRecode"),e.recodePlanConfirmModal=!1;var r=[{groupIndex:-2,playerIndex:-2,channelId:"",business:{},player:{isVisible:!0}}];e.setQmlPlayerProperty(r);var a,i=Object(s["a"])(n);try{for(i.s();!(a=i.n()).done;){var o=a.value;(o.playerIndex===e.receiveObj.playerIndex||o.channelId===e.receiveObj.channelId)&&(o.business.isRecording=!1)}}catch(l){i.e(l)}finally{i.f()}e.setQmlPlayerProperty(n),sessionStorage.setItem("monitorState",JSON.stringify(n))}),(function(t){e.setQmlPlayerProperty(n),e.recodePlanConfirmModal=!1}))}},recodeCancel:function(){this.recodePlanConfirmModal=!1;var e=JSON.parse(sessionStorage.getItem("monitorState"));this.setQmlPlayerProperty(e);var t=[{groupIndex:-2,playerIndex:-2,channelId:"",business:{},player:{isVisible:!0}}];this.setQmlPlayerProperty(t)},dottingConfirm:function(){var e=this;if(!this.dottingName)return this.$Message.info("请输入打点名称"),!1;if(!this.dottingName.trim())return this.$Message.info("名称不能仅包含空格"),!1;var t,r=JSON.parse(sessionStorage.getItem("monitorState")),a="",n=Object(s["a"])(r);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o.playerIndex===this.receiveObj.playerIndex){a=o.timestamp;break}}}catch(c){n.e(c)}finally{n.f()}var l={channelId:this.receiveObj.channelId,name:this.dottingName,startDate:this.timestampToTime(a),endDate:this.timestampToTime(this.receiveObj.timestamp),type:"2"};i["a"].createChannelProgram(l).then((function(t){e.$Message.success("导播节目添加成功"),e.$emit("dottedSuccess");var a,n=Object(s["a"])(r);try{for(n.s();!(a=n.n()).done;){var i=a.value;(i.playerIndex===e.receiveObj.playerIndex||i.channelId===e.receiveObj.channelId)&&(i.business.isDotting=!1)}}catch(c){n.e(c)}finally{n.f()}e.setQmlPlayerProperty(r),sessionStorage.setItem("monitorState",JSON.stringify(r)),e.dottingModal=!1}),(function(t){e.setQmlPlayerProperty(r)}))},dottingCancel:function(){var e=JSON.parse(sessionStorage.getItem("monitorState"));this.dottingModal=!1,this.setQmlPlayerProperty(e)},timestampToTime:function(e){var t=new Date(1e3*e),r=t.getFullYear(),a=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,n=t.getDate(),s=t.getHours(),i=t.getMinutes(),o=t.getSeconds();return r+"-"+a+"-"+n+" "+s+":"+i+":"+o},setQmlPlayerServerTime:function(e){var t={serverUnixTimestamp:e};this.$sumaQtPlayer.setServerTime(JSON.stringify(t),(function(e){}))},createQmlPlayer:function(e,t,r,a,n,s,i){var o=this;o.playerType="rec",sessionStorage.setItem("playerType","rec");var l={mode:i,x:e,y:t,width:r,height:a,rows:n,columns:s};this.$sumaQtPlayer.createPlayer(JSON.stringify(l),(function(e){var t=JSON.parse(e);if("OK"===t.status){o.prepareQmlPlayer1();var r=JSON.parse(sessionStorage.getItem("monitorState"));r&&o.setQmlPlayerProperty(r)}}))},prepareQmlPlayer:function(e,t,r,a,n,i,o){var l=this,c=[{x:e,y:t,groupIndex:-1,playerIndex:-1,playerInfo:{channelId:a,channelName:r,channelUrl:n,timeshiftTotalInSec:o}}];this.recordPlayUrlChange=sessionStorage.getItem("initPlay")?JSON.parse(sessionStorage.getItem("initPlay")):[],this.$sumaQtPlayer.preparePlayer(JSON.stringify(c),(function(e){var t=JSON.parse(e);if("OK"===t.status){var c=[{playerIndex:t.data[0].playerIndex,groupIndex:t.data[0].groupIndex,channelId:t.data[0].channelId,business:{isRecording:i,isDotting:!1},player:{}}];if(l.setQmlPlayerProperty(c),sessionStorage.getItem("monitorState")){var d,y=JSON.parse(sessionStorage.getItem("monitorState")),m=!0,u=Object(s["a"])(y);try{for(u.s();!(d=u.n()).done;){var f=d.value;f.playerIndex===c[0].playerIndex&&(m=!1,f.channelId=c[0].channelId,f.business=c[0].business,f.player=c[0].player,sessionStorage.setItem("monitorState",JSON.stringify(y)))}}catch(P){u.e(P)}finally{u.f()}m&&(y.push(c[0]),sessionStorage.setItem("monitorState",JSON.stringify(y)))}else sessionStorage.setItem("monitorState",JSON.stringify(c));var g={x:100,y:100};g.playerIndex=JSON.parse(e).data[0].playerIndex,g.groupIndex=JSON.parse(e).data[0].groupIndex,g.playerInfo={channelId:a,channelName:r,channelUrl:n,timeshiftTotalInSec:o};var p,h=!0,S=Object(s["a"])(l.recordPlayUrlChange);try{for(S.s();!(p=S.n()).done;){var I=p.value;if(I.playerIndex===g.playerIndex){for(var v in g)l.$set(I,v,g[v]);h=!1;break}}}catch(P){S.e(P)}finally{S.f()}h&&l.recordPlayUrlChange.push(g),sessionStorage.setItem("initPlay",JSON.stringify(l.recordPlayUrlChange))}}))},prepareQmlPlayer1:function(){var e=[];if(this.recordPlayUrlChange=sessionStorage.getItem("initPlay")?JSON.parse(sessionStorage.getItem("initPlay")):[],!this.recordPlayUrlChange.length)return!1;var t,r=Object(s["a"])(this.recordPlayUrlChange);try{for(r.s();!(t=r.n()).done;){var a=t.value,n={x:100,y:100};n.playerIndex=a.playerIndex,n.groupIndex=a.groupIndex,n.playerInfo=a.playerInfo,e.push(n)}}catch(i){r.e(i)}finally{r.f()}this.$sumaQtPlayer.preparePlayer(JSON.stringify(e),(function(e){}))},prepareQmlPlayer2:function(e){this.$sumaQtPlayer.preparePlayer(JSON.stringify(e),(function(e){}))},setQmlPlayerProperty:function(e){this.$sumaQtPlayer.setPlayerProperty(JSON.stringify(e),(function(e){}))},adjustQmlPlayer:function(e){this.$sumaQtPlayer.adjustPlayer(JSON.stringify(e),(function(e){}))},replaceVideoWithPlayer1:function(e){var t=this;t.playerType="base",sessionStorage.setItem("playerType","base"),this.$sumaQtPlayer.replaceVideoWithPlayer(JSON.stringify(e),(function(e){}))},destroyQmlPlayer:function(e){this.$sumaQtPlayer.destroyPlayer(JSON.stringify(e),(function(e){}))},setVersionInfo:function(e){this.$sumaQtPlayer.setVersionInfo(JSON.stringify(e),(function(e){}))},getVersion:function(){var e=this,t={};i["a"].getVersion(t).then((function(t){t.result;var r={versionCode:0,versionName:t.result,versionDescription:""};e.setVersionInfo(r)}))}}},l=o,c=(r("b87d"),r("2877")),d=Object(c["a"])(l,a,n,!1,null,null,null);t["default"]=d.exports}}]);
//# sourceMappingURL=chunk-4fabfa07.ea7303b8.js.map