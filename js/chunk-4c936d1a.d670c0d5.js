(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c936d1a"],{"0f16":function(e,o,t){},"5c74":function(e,o,t){"use strict";t.r(o);var r=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",[t("div",{staticStyle:{width:"100%",height:"38px",background:"rgba(13,67,111,1)","box-shadow":"0px 2px 10px 0px rgba(0, 0, 0, 0.05)","font-size":"14px","font-family":"Microsoft YaHei","font-weight":"400",color:"rgba(255,255,255,1)","padding-left":"24px","line-height":"38px"}},[e._v(" 修改操作员 ")]),t("Row",[t("Col",[t("Card",{staticStyle:{margin:"10px"},style:{height:e.tabHeight+"px"}},[t("Row",{staticStyle:{"margin-top":"20px"},attrs:{type:"flex",justify:"center"}},[t("Col",[t("Form",{ref:"operatorUpdate",attrs:{model:e.operatorUpdate,rules:e.operatorUpdateRule,"label-position":"right","label-width":130}},[t("FormItem",{attrs:{label:"名称",prop:"operatorName"}},[t("Input",{staticStyle:{width:"466px",height:"32px"},attrs:{type:"text",maxlength:20,disabled:!0,placeholder:"请输入"},model:{value:e.operatorUpdate.operatorName,callback:function(o){e.$set(e.operatorUpdate,"operatorName",o)},expression:"operatorUpdate.operatorName"}}),t("span",{staticStyle:{color:"rgba(175,188,204,1)","margin-left":"10px"}},[e._v(e._s(e.operatorNameLength)+"/20")])],1),t("RadioGroup",{staticStyle:{"padding-left":"130px","padding-bottom":"10px"},on:{"on-change":e.selectedAuthority},model:{value:e.operatorUpdate.chooseAuthority,callback:function(o){e.$set(e.operatorUpdate,"chooseAuthority",o)},expression:"operatorUpdate.chooseAuthority"}},[t("Radio",{attrs:{label:"通过角色赋权限"}},[t("span",{staticStyle:{color:"rgba(255,255,255,1)"}},[e._v("通过角色赋权限")])]),t("Radio",{staticStyle:{"margin-left":"70px"},attrs:{label:"自定义权限"}},[t("span",{staticStyle:{color:"rgba(255,255,255,1)"}},[e._v("自定义权限")])])],1),t("FormItem",{directives:[{name:"show",rawName:"v-show",value:"通过角色赋权限"===e.operatorUpdate.chooseAuthority,expression:"operatorUpdate.chooseAuthority==='通过角色赋权限'"}],attrs:{label:"选择角色",prop:"chooseRole"}},[t("RadioGroup",{staticStyle:{overflow:"auto"},style:{height:e.tabHeight-210+"px"},attrs:{vertical:""},on:{"on-change":e.selectedRole},model:{value:e.operatorUpdate.chooseRole,callback:function(o){e.$set(e.operatorUpdate,"chooseRole",o)},expression:"operatorUpdate.chooseRole"}},e._l(e.roleList,(function(o,r){return t("div",{key:r},[t("Radio",{attrs:{label:o.roleId}},[t("span",{staticStyle:{color:"rgba(255,255,255,1)"}},[e._v(e._s(o.name)+"（"+e._s(o.description)+"）")])]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.operatorUpdate.chooseRole==o.roleId,expression:"operatorUpdate.chooseRole==item.roleId"}]},[t("Row",[t("Col",{staticStyle:{"margin-left":"30px",display:"flex","align-items":"flex-start"}},[t("span",{staticStyle:{color:"rgba(255,255,255,1)"}},[e._v("可访问的功能菜单")]),t("div",{staticStyle:{width:"300px",height:"240px",border:"1px solid rgba(87,111,140,1)","border-radius":"2px",overflow:"auto","margin-top":"10px","margin-left":"10px",background:"#163C69"}},[t("el-tree",{ref:"menuPermissionTree",refInFor:!0,attrs:{id:"adminUpdateTree",data:e.menuPermission,"node-key":"id","default-checked-keys":e.selectedItemPermissionsElement,"show-checkbox":"","default-expand-all":""},on:{check:function(o,t){e.handleCheckChange(o,t)}}})],1)])],1),t("Row",[t("Col",{staticStyle:{"margin-left":"30px",display:"flex","align-items":"flex-start"}},[t("span",{staticStyle:{color:"rgba(255,255,255,1)"}},[e._v("可操作的权限")]),t("div",{staticStyle:{"margin-left":"10px"}},[t("CheckboxGroup",{staticStyle:{color:"rgba(255,255,255,1)"},on:{"on-change":e.checkAllGroup},model:{value:e.operatorUpdate.operationPermissionArray,callback:function(o){e.$set(e.operatorUpdate,"operationPermissionArray",o)},expression:"operatorUpdate.operationPermissionArray"}},[t("Checkbox",{attrs:{label:"允许查看",disabled:"",id:"enableWatch"}}),t("Checkbox",{attrs:{label:"允许操作",disabled:"",id:"enableOperation"}})],1)],1)])],1)],1)],1)})),0)],1),t("FormItem",{directives:[{name:"show",rawName:"v-show",value:"自定义权限"===e.operatorUpdate.chooseAuthority,expression:"operatorUpdate.chooseAuthority==='自定义权限'"}],attrs:{label:"可访问的功能菜单"}},[t("div",{staticStyle:{width:"464px",height:"260px",border:"1px solid #576F8C","border-radius":"2px",overflow:"auto","margin-top":"10px",background:"#163C69"},style:{height:e.tabHeight-300+"px"}},[t("el-tree",{attrs:{id:"adminCreateTree",data:e.menuPermission1,"node-key":"id","default-checked-keys":e.selectedItemPermissionsElement1,"show-checkbox":"","default-expand-all":""},on:{check:function(o,t){e.handleCheckChange(o,t)}}})],1)]),t("FormItem",{directives:[{name:"show",rawName:"v-show",value:"自定义权限"===e.operatorUpdate.chooseAuthority,expression:"operatorUpdate.chooseAuthority==='自定义权限'"}],attrs:{label:"可操作的权限"}},[t("CheckboxGroup",{staticStyle:{color:"rgba(255,255,255,1)"},on:{"on-change":e.checkAllGroup1},model:{value:e.operatorUpdate.operationPermissionArray1,callback:function(o){e.$set(e.operatorUpdate,"operationPermissionArray1",o)},expression:"operatorUpdate.operationPermissionArray1"}},[t("Checkbox",{attrs:{label:"允许查看",disabled:"",id:"enableWatch"}}),t("Checkbox",{attrs:{label:"允许操作",id:"enableOperation"}})],1)],1),t("FormItem",{staticStyle:{"margin-left":"120px"}},[t("Button",{staticStyle:{background:"rgba(13,67,111,1)",color:"rgba(199,219,244,1)"},on:{click:e.cancelUpdateOperator}},[e._v("取消")]),t("Button",{staticStyle:{"margin-left":"49px"},attrs:{type:"primary"},on:{click:function(o){return e.confirmUpdateOperator("operatorUpdate")}}},[e._v("确定")])],1)],1)],1)],1)],1)],1)],1)],1)},s=[],i=(t("c975"),t("b0c0"),t("d3b7"),t("25f0"),t("53ca")),a=t("b85c"),n=t("4ec3"),l={data:function(){var e=this,o=function(o,t,r){return t?t.length>20?(e.operatorNameLength=t.length,r(new Error("操作员名称过长,请重新输入!"))):(e.operatorNameLength=t.length,void r()):(e.operatorNameLength=0,r(new Error("操作员名称不能为空!")))};return{operatorUpdate:{operatorName:"",chooseAuthority:"通过角色赋权限",chooseRole:"",operationPermissionArray:["允许查看"],operationPermissionArray1:["允许查看"]},operatorUpdateRule:{operatorName:[{required:!0,message:"操作员名称不能为空!",trigger:"blur"},{required:!0,validator:o,trigger:"change"}]},roleList:[],operationPermissions:0,operationPermissions1:0,roleIds:[],roleOnlyIds:[],selectedItemPermissionsElement:[],selectedItemPermissionsElement1:[],notLeaf:[],notLeaf1:[],permissionIds:[],permissionOnlyIds:[],choosedMenuIds:[],choosedMenuOnlyIds:[],operatorNameLength:0,selectedItemPermissions:[],selectedItemNewPermissions:[],selectedItemPermissions1:[],selectedItemNewPermissions1:[],isCheck:!1,isCheck1:!1,menuPermission:[],menuPermission1:[],base:1,tabHeight:0}},created:function(){this.isCheck=!1,this.getRoleStatus()},mounted:function(){this.autoFix()},methods:{autoFix:function(){var e=this;this.getDom(),window.onresize=function(){e.getDom()}},getDom:function(){var e=window.innerWidth,o=window.innerHeight;this.base=(e-160)/864,this.tabHeight=o-130},getRoleStatus:function(){var e=JSON.parse(sessionStorage.getItem("operatorParam"));e&&(0==e.roleStatus?(this.operatorUpdate.chooseAuthority="通过角色赋权限",this.queryRoleList(),this.queryOperatorInfo()):1==e.roleStatus&&(this.operatorUpdate.chooseAuthority="自定义权限",this.queryOperatorInfo1()))},selectedAuthority:function(e){this.operatorUpdate.chooseAuthority=e,"自定义权限"===e?this.getTheWholeTree2():"通过角色赋权限"===e&&(this.queryRoleList(),this.queryOperatorInfo())},queryRoleList:function(){var e=this,o={status:0};n["a"].roleSearchListByName(o).then((function(o){o.result&&(e.roleList=o.result)}))},queryOperatorInfo:function(){var e=this,o=JSON.parse(sessionStorage.getItem("operatorParam"));if(o){var t={id:o.id,useId:o.userId};n["a"].specificJson(t).then((function(o){e.roleIds=[],e.roleOnlyIds=[],e.operatorUpdate.operatorName=o.result.name,e.operatorUpdate.chooseRole=o.result.roles[0].roleNewId,e.roleIds.push(o.result.roles[0].roleId),e.roleOnlyIds.push(o.result.roles[0].roleNewId);var t,r=Object(a["a"])(e.roleList);try{for(r.s();!(t=r.n()).done;){var s=t.value;s.roleId===o.result.roles[0].roleNewId&&(e.queryRolePermission(s),e.operatorUpdate.operationPermissionArray=[],e.operationPermissions=s.operationPermissions,1===e.operationPermissions?e.operatorUpdate.operationPermissionArray=["允许查看","允许操作"]:e.operatorUpdate.operationPermissionArray=["允许查看"])}}catch(i){r.e(i)}finally{r.f()}sessionStorage.setItem("operatorInfo",JSON.stringify(o.result))}))}},selectedRole:function(e){if(e){var o,t;this.isCheck1=!0,this.roleIds=[],this.roleOnlyIds=[];var r,s=Object(a["a"])(this.roleList);try{for(s.s();!(r=s.n()).done;){var i=r.value;e===i.roleId&&(this.queryRoleInfo(i),o=i.id,t=i.roleId)}}catch(n){s.e(n)}finally{s.f()}this.roleIds.push(o),this.roleOnlyIds.push(t)}},queryRoleInfo:function(e){this.queryRolePermission(e),this.operatorUpdate.operationPermissionArray=[],this.operationPermissions=e.operationPermissions,1===this.operationPermissions?this.operatorUpdate.operationPermissionArray=["允许查看","允许操作"]:this.operatorUpdate.operationPermissionArray=["允许查看"]},queryRolePermission:function(e){var o=this;if(e){var t={id:e.id,roleId:e.roleId};n["a"].getSelectedItemPermissions(t).then((function(e){e=e.result;var t=[],r=[];if(e.length>0)for(var s=0;s<e.length;s++)t.push(parseInt(e[s].id)),r.push(e[s].permissionId);o.selectedItemPermissions=t,o.selectedItemNewPermissions=r,o.getTheWholeTree(e)}))}},getTheWholeTree:function(e){var o=this,t={systemType:"2"};n["a"].searchMenuList(t).then((function(t){t=t.result,o.menuPermission=[];for(var r=0;r<t.length;r++)o.jsonData(t[r]);o.selectedItemPermissionsElement=[];var s,i=Object(a["a"])(e);try{for(i.s();!(s=i.n()).done;){var n=s.value;-1===o.notLeaf.indexOf(n.id)&&o.selectedItemPermissionsElement.push(parseInt(n.id))}}catch(l){i.e(l)}finally{i.f()}o.menuPermission=t}))},jsonData:function(e){if("object"===Object(i["a"])(e)&&e.constructor===Object.prototype.constructor){var o=[];o.push(e)}else o=e;for(var t=0;t<o.length;t++){var r=o[t];0!==r.permissions.length&&this.notLeaf.push(r.id.toString()),r.label=r.name,r.children=r.permissions,r.expand=!0,"通过角色赋权限"===this.operatorUpdate.chooseAuthority?r.disabled=!0:"自定义权限"===this.operatorUpdate.chooseAuthority&&(r.disabled=!1),r.children&&r.children.length>0?this.jsonData(r.children):0===r.parentId&&(r.disabled=!0)}},checkAllGroup:function(e){2===e.length?this.operationPermissions=1:1===e.length&&(this.operationPermissions=0)},queryOperatorInfo1:function(){var e=this,o=JSON.parse(sessionStorage.getItem("operatorParam"));if(o){var t={id:o.id,useId:o.userId};n["a"].specificJson(t).then((function(o){console.log("操作员详情",o.result),e.operatorUpdate.operatorName=o.result.name;var t={};t.id=o.result.roles[0].roleId,t.roleId=o.result.roles[0].roleNewId;var r=[],s=[];r.push(o.result.roles[0].roleId),s.push(o.result.roles[0].roleNewId),e.queryRolePermission1(t),e.roleSearchById(r,s),sessionStorage.setItem("operatorInfo",JSON.stringify(o.result))}))}},queryRolePermission1:function(e){var o=this;if(e){var t={id:e.id,roleId:e.roleId};this.isCheck=!1,n["a"].getSelectedItemPermissions(t).then((function(e){e=e.result;var t=[],r=[];if(e.length>0)for(var s=0;s<e.length;s++)t.push(parseInt(e[s].id)),r.push(e[s].permissionId);o.selectedItemPermissions1=t,o.selectedItemNewPermissions1=r,o.getTheWholeTree1(e)}))}},getTheWholeTree1:function(e){var o=this,t={systemType:"2"};n["a"].searchMenuList(t).then((function(t){t=t.result,o.menuPermission1=[];for(var r=0;r<t.length;r++)o.jsonData1(t[r]);o.selectedItemPermissionsElement1=[];var s,i=Object(a["a"])(e);try{for(i.s();!(s=i.n()).done;){var n=s.value;-1===o.notLeaf1.indexOf(n.id)&&o.selectedItemPermissionsElement1.push(parseInt(n.id))}}catch(l){i.e(l)}finally{i.f()}o.menuPermission1=t}))},jsonData1:function(e){if("object"===Object(i["a"])(e)&&e.constructor===Object.prototype.constructor){var o=[];o.push(e)}else o=e;for(var t=0;t<o.length;t++){var r=o[t];0!==r.permissions.length&&this.notLeaf1.push(r.id.toString()),r.label=r.name,r.children=r.permissions,r.expand=!0,"通过角色赋权限"===this.operatorUpdate.chooseAuthority?r.disabled=!0:"自定义权限"===this.operatorUpdate.chooseAuthority&&(r.disabled=!1),r.children&&r.children.length>0?this.jsonData1(r.children):0===r.parentId&&(r.disabled=!0)}},getTheWholeTree2:function(){var e=this,o={systemType:"2"};n["a"].searchMenuList(o).then((function(o){o=o.result,e.menuPermission1=[];for(var t=0;t<o.length;t++)e.jsonData1(o[t]);e.menuPermission1=o}))},roleSearchById:function(e,o){var t=this,r={idList:e,roleIdList:o};n["a"].roleSearchById(r).then((function(e){for(var o in console.log("根据Id查询角色信息",e),e)t.operationPermissions1=e[o].operationPermissions;1==t.operationPermissions1?t.operatorUpdate.operationPermissionArray1=["允许查看","允许操作"]:0==t.operationPermissions1&&(t.operatorUpdate.operationPermissionArray1=["允许查看"])}))},handleCheckChange:function(e,o){var t=o.checkedNodes,r=o.halfCheckedNodes;this.choosedMenuIds=[],this.choosedMenuOnlyIds=[];var s,i=Object(a["a"])(t);try{for(i.s();!(s=i.n()).done;){var n=s.value;this.choosedMenuIds.push(n.id),this.choosedMenuOnlyIds.push(n.permissionId)}}catch(h){i.e(h)}finally{i.f()}var l,d=Object(a["a"])(r);try{for(d.s();!(l=d.n()).done;){var p=l.value;this.choosedMenuIds.push(p.id),this.choosedMenuOnlyIds.push(p.permissionId)}}catch(h){d.e(h)}finally{d.f()}this.isCheck=!0},checkAllGroup1:function(e){2===e.length?this.operationPermissions1=1:1===e.length&&(this.operationPermissions1=0)},cancelUpdateOperator:function(){this.operatorNameLength=0,this.$router.push({name:"system-manage-admin"})},confirmUpdateOperator:function(e){var o=this,t=JSON.parse(sessionStorage.getItem("operatorInfo")),r=JSON.parse(sessionStorage.getItem("operatorParam"));"通过角色赋权限"===this.operatorUpdate.chooseAuthority?this.$refs[e].validate((function(e){if(e){if(0==o.isCheck1&&1==r.roleStatus)return o.$Message.info("请选择角色"),!1;if(0===o.roleIds.length||0===o.roleOnlyIds.length)return o.$Message.info("请选择角色"),!1;if(0===o.selectedItemPermissions.length||0===o.selectedItemNewPermissions.length)return o.$Message.info("请选择菜单"),!1;var s={id:t.id,userOnlyId:t.userId,userName:o.operatorUpdate.operatorName,operationPermissions:o.operationPermissions,roleIds:o.roleIds,roleOnlyIds:o.roleOnlyIds,permissionIds:o.selectedItemPermissions,permissionOnlyIds:o.selectedItemNewPermissions};n["a"].updateOperatorJson(s).then((function(e){o.$Message.success("修改操作员成功!"),o.roleIds=[],o.roleOnlyIds=[],o.permissionIds=[],o.permissionOnlyIds=[],o.operationPermissions=0,o.operatorNameLength=0,o.$router.push({name:"system-manage-admin"})}),(function(e){o.operatorNameLength=0}))}})):"自定义权限"===this.operatorUpdate.chooseAuthority&&this.$refs[e].validate((function(e){if(0===o.selectedItemPermissionsElement1.length){if(0==o.isCheck&&0==o.choosedMenuIds.length)return o.$Message.info("请选择菜单"),!1;if(1==o.isCheck&&0==o.choosedMenuIds.length)return o.$Message.info("请选择菜单"),!1;var r={id:t.id,userOnlyId:t.userId,userName:o.operatorUpdate.operatorName,operationPermissions:o.operationPermissions1,permissionIds:o.choosedMenuIds,permissionOnlyIds:o.choosedMenuOnlyIds};n["a"].updateOperatorJson(r).then((function(e){o.$Message.success("修改操作员成功！"),o.roleIds=[],o.roleOnlyIds=[],o.permissionIds=[],o.permissionOnlyIds=[],o.operationPermissions1=0,o.operatorNameLength=0,o.$router.push({name:"system-manage-admin"})}),(function(e){o.operatorNameLength=0}))}else{if(1==o.isCheck&&0==o.choosedMenuIds.length)return o.$Message.info("请选择菜单"),!1;if(1==o.isCheck&&0!=o.choosedMenuIds.length){var s={id:t.id,userOnlyId:t.userId,userName:o.operatorUpdate.operatorName,operationPermissions:o.operationPermissions1,permissionIds:o.choosedMenuIds,permissionOnlyIds:o.choosedMenuOnlyIds};n["a"].updateOperatorJson(s).then((function(e){o.$Message.success("修改操作员成功！"),o.roleIds=[],o.roleOnlyIds=[],o.permissionIds=[],o.permissionOnlyIds=[],o.operationPermissions1=0,o.operatorNameLength=0,o.$router.push({name:"system-manage-admin"})}),(function(e){o.operatorNameLength=0}))}else{var i={id:t.id,userOnlyId:t.userId,userName:o.operatorUpdate.operatorName,operationPermissions:o.operationPermissions1,permissionIds:o.selectedItemPermissions1,permissionOnlyIds:o.selectedItemNewPermissions1};n["a"].updateOperatorJson(i).then((function(e){o.$Message.success("修改操作员成功!"),o.roleIds=[],o.roleOnlyIds=[],o.permissionIds=[],o.permissionOnlyIds=[],o.operationPermissions1=0,o.operatorNameLength=0,o.$router.push({name:"system-manage-admin"})}),(function(e){o.operatorNameLength=0}))}}}))},handleReset:function(e){this.$refs[e].resetFields()}}},d=l,p=(t("909a"),t("2877")),h=Object(p["a"])(d,r,s,!1,null,null,null);o["default"]=h.exports},"909a":function(e,o,t){"use strict";var r=t("0f16"),s=t.n(r);s.a}}]);
//# sourceMappingURL=chunk-4c936d1a.d670c0d5.js.map