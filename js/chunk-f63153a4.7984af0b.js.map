{"version":3,"sources":["webpack:///./src/views/system-manage/components/role-create.vue?b2f8","webpack:///src/views/system-manage/components/role-create.vue","webpack:///./src/views/system-manage/components/role-create.vue?b233","webpack:///./src/views/system-manage/components/role-create.vue?3962","webpack:///./src/views/system-manage/components/role-create.vue?881a"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticStyle","_v","style","height","tabHeight","attrs","ref","roleNew","roleNewRule","model","value","callback","$$v","$set","expression","_s","roleNameLength","descriptionLength","menuPermission","selectedItemPermissionsElement","on","checkAllGroup","cancelCreateRole","$event","confirmCreateRole","staticRenderFns","data","Error","roleName","description","operationPermissionArray","operationPermissions","choosedMenuIds","choosedMenuOnlyIds","notLeaf","base","created","queryMenuTree","mounted","autoFix","methods","getDom","window","onresize","vm","width","systemType","api","jsonData","array","push","jsonTree","jn","permissions","length","id","toString","label","name","children","expand","disabled","getUserChoosedMenuInfo","$router","$refs","validate","roleDescription","permissionIds","permissionOnlyIds","handleReset","resetFields","component"],"mappings":"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","file":"js/chunk-f63153a4.7984af0b.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticStyle:{\"width\":\"100%\",\"height\":\"38px\",\"background\":\"rgba(13,67,111,1)\",\"box-shadow\":\"0px 2px 10px 0px rgba(0, 0, 0, 0.05)\",\"font-size\":\"14px\",\"font-family\":\"Microsoft YaHei\",\"font-weight\":\"400\",\"color\":\"rgba(255,255,255,1)\",\"padding-left\":\"24px\",\"line-height\":\"38px\"}},[_vm._v(\" 新建角色 \")]),_c('Row',[_c('Col',[_c('Card',{staticStyle:{\"margin\":\"10px\"},style:({ height:_vm.tabHeight + 'px' })},[_c('Row',{staticStyle:{\"margin-top\":\"20px\"},attrs:{\"type\":\"flex\",\"justify\":\"center\"}},[_c('Col',[_c('Form',{ref:\"roleNew\",attrs:{\"model\":_vm.roleNew,\"rules\":_vm.roleNewRule,\"label-position\":\"right\",\"label-width\":100}},[_c('FormItem',{attrs:{\"label\":\"名称\",\"prop\":\"roleName\"}},[_c('Input',{staticStyle:{\"width\":\"466px\",\"height\":\"32px\"},attrs:{\"type\":\"text\",\"maxlength\":20,\"placeholder\":\"请输入\"},model:{value:(_vm.roleNew.roleName),callback:function ($$v) {_vm.$set(_vm.roleNew, \"roleName\", $$v)},expression:\"roleNew.roleName\"}}),_c('span',{staticStyle:{\"color\":\"rgba(175,188,204,1)\",\"margin-left\":\"10px\"}},[_vm._v(_vm._s(_vm.roleNameLength)+\"/20\")])],1),_c('FormItem',{attrs:{\"label\":\"描述\",\"prop\":\"description\"}},[_c('Input',{staticStyle:{\"width\":\"466px\",\"height\":\"32px\"},attrs:{\"type\":\"text\",\"maxlength\":50,\"placeholder\":\"请输入\"},model:{value:(_vm.roleNew.description),callback:function ($$v) {_vm.$set(_vm.roleNew, \"description\", $$v)},expression:\"roleNew.description\"}}),_c('span',{staticStyle:{\"color\":\"rgba(175,188,204,1)\",\"margin-left\":\"10px\"}},[_vm._v(_vm._s(_vm.descriptionLength)+\"/50\")])],1),_c('FormItem',{attrs:{\"label\":\"菜单权限\"}},[_c('div',{staticStyle:{\"width\":\"464px\",\"height\":\"326px\",\"border\":\"1px solid rgba(87,111,140,1)\",\"border-radius\":\"2px\",\"margin-top\":\"10px\",\"overflow\":\"auto\",\"background\":\"rgba(22,60,105,1)\"},style:({height:_vm.tabHeight-320 + 'px'})},[_c('el-tree',{ref:\"menuPermissionTree\",attrs:{\"id\":\"roleCreateTree\",\"data\":_vm.menuPermission,\"node-key\":\"id\",\"default-checked-keys\":_vm.selectedItemPermissionsElement,\"show-checkbox\":\"\",\"default-expand-all\":\"\"}})],1)]),_c('FormItem',{attrs:{\"label\":\"操作权限\"}},[_c('CheckboxGroup',{staticStyle:{\"color\":\"rgba(255,255,255,1)\"},on:{\"on-change\":_vm.checkAllGroup},model:{value:(_vm.roleNew.operationPermissionArray),callback:function ($$v) {_vm.$set(_vm.roleNew, \"operationPermissionArray\", $$v)},expression:\"roleNew.operationPermissionArray\"}},[_c('Checkbox',{attrs:{\"label\":\"允许查看\",\"disabled\":\"\",\"id\":\"enableWatch\"}}),_c('Checkbox',{attrs:{\"label\":\"允许操作\",\"id\":\"enableOperation\"}})],1)],1),_c('div',{staticStyle:{\"text-align\":\"center\"}},[_c('Button',{staticStyle:{\"background\":\"rgba(13,67,111,1)\",\"color\":\"rgba(199,219,244,1)\",\"margin-left\":\"60px\"},on:{\"click\":_vm.cancelCreateRole}},[_vm._v(\"取消\")]),_c('Button',{staticStyle:{\"margin-left\":\"60px\"},attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.confirmCreateRole('roleNew')}}},[_vm._v(\"确定\")])],1)],1)],1)],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div\r\n      style=\"width:100%;\r\n          height:38px;\r\n          background:rgba(13,67,111,1);\r\n          box-shadow:0px 2px 10px 0px rgba(0, 0, 0, 0.05);\r\n          font-size:14px;\r\n          font-family:Microsoft YaHei;\r\n          font-weight:400;\r\n          color:rgba(255,255,255,1);\r\n          padding-left:24px;\r\n          line-height:38px;\"\r\n      >\r\n      新建角色\r\n    </div>\r\n    <Row>\r\n      <Col>\r\n        <Card style=\"margin:10px;\" :style=\"{ height:tabHeight + 'px' }\">\r\n          <Row type=\"flex\" justify=\"center\" style=\"margin-top:20px;\">\r\n            <!-- <Col span=\"19\" offset=\"2\"> -->\r\n            <Col>\r\n              <Form ref=\"roleNew\" :model=\"roleNew\" :rules=\"roleNewRule\" label-position=\"right\" :label-width=\"100\">\r\n                <FormItem label=\"名称\" prop=\"roleName\">\r\n                  <Input type=\"text\" v-model=\"roleNew.roleName\" :maxlength=\"20\" placeholder=\"请输入\" style=\"width:466px;height:32px;\"></Input>\r\n                  <span style=\"color:rgba(175,188,204,1);margin-left:10px;\">{{ roleNameLength }}/20</span>\r\n                </FormItem>\r\n                <FormItem label=\"描述\" prop=\"description\">\r\n                  <Input type=\"text\" v-model=\"roleNew.description\" :maxlength=\"50\" placeholder=\"请输入\" style=\"width:466px;height:32px;\"></Input>\r\n                  <span style=\"color:rgba(175,188,204,1);margin-left:10px;\">{{ descriptionLength }}/50</span>\r\n                </FormItem>\r\n                <FormItem label=\"菜单权限\" style=\"\">\r\n                  <div \r\n                    style=\"width:464px;\r\n                          height:326px;\r\n                          border:1px solid rgba(87,111,140,1);\r\n                          border-radius:2px;\r\n                          margin-top:10px;\r\n                          overflow:auto;\r\n                          background:rgba(22,60,105,1);\r\n                          \"\r\n                    :style=\"{height:tabHeight-320 + 'px'}\"\r\n                    >\r\n                    <el-tree\r\n                      id=\"roleCreateTree\"\r\n                      ref=\"menuPermissionTree\"\r\n                      :data=\"menuPermission\"\r\n                      node-key=\"id\"\r\n                      :default-checked-keys=\"selectedItemPermissionsElement\"\r\n                      show-checkbox\r\n                      default-expand-all>\r\n                    </el-tree>\r\n                  </div> \r\n                </FormItem>\r\n                <FormItem label=\"操作权限\">\r\n                  <CheckboxGroup v-model=\"roleNew.operationPermissionArray\" @on-change=\"checkAllGroup\" style=\"color:rgba(255,255,255,1);\">\r\n                    <Checkbox label=\"允许查看\" disabled id=\"enableWatch\"></Checkbox>\r\n                    <Checkbox label=\"允许操作\" id=\"enableOperation\"></Checkbox>\r\n                  </CheckboxGroup>\r\n                </FormItem>\r\n                <!-- <FormItem style=\"text-align:center\"> -->\r\n                <div style=\"text-align:center\">\r\n                  <Button @click=\"cancelCreateRole\" style=\"background:rgba(13,67,111,1);color:rgba(199,219,244,1);margin-left:60px;\">取消</Button>\r\n                  <Button type=\"primary\" @click=\"confirmCreateRole('roleNew')\" style=\"margin-left:60px;\">确定</Button>\r\n                </div>\r\n                <!-- </FormItem> -->\r\n              </Form>\r\n            </Col>\r\n          </Row> \r\n        </Card>\r\n      </Col>\r\n    </Row>\r\n  </div>\r\n</template>\r\n<script>\r\nimport api from '@/api/api';\r\n\r\nexport default {\r\n  data () {\r\n    /** 新建角色名称长度校验 */\r\n    const validateRoleNameLength = (rule, value, callback) => {\r\n      if (!value) {\r\n        this.roleNameLength = 0;\r\n        return callback(new Error(\"角色名称不能为空!\"));\r\n      } else if (value.length > 20) {\r\n        this.roleNameLength = value.length;\r\n        return callback(new Error(\"角色名称过长,请重新输入!\"));\r\n      } else {\r\n        this.roleNameLength = value.length;\r\n        callback();\r\n      }\r\n    };\r\n\r\n    /** 新建角色描述长度校验 */\r\n    const validateDescription = (rule, value, callback) => {\r\n      if (!value) {\r\n        this.descriptionLength = 0;\r\n        return callback(new Error(\"角色描述不能为空!\"));\r\n      } else if (value.length > 50) {\r\n        this.descriptionLength = value.length;\r\n        return callback(new Error(\"角色描述过长,请重新输入!\"));\r\n      } else {\r\n        this.descriptionLength = value.length;\r\n        callback();\r\n      }\r\n    };\r\n\r\n    return {\r\n      roleNew:{\r\n        roleName:'', // 新建角色 名称\r\n        description:'', // 新建角色 描述\r\n        operationPermissionArray:['允许查看'], // 操作权限数组\r\n      },\r\n      roleNewRule:{\r\n        roleName:[\r\n          { required: true, message: '角色名称不能为空!', trigger: 'blur' },\r\n          { required: true, validator: validateRoleNameLength, trigger: \"change\" },\r\n        ],\r\n        description:[\r\n          { required: true, message: '角色描述不能为空!', trigger: 'blur' },\r\n          { required: true, validator: validateDescription, trigger: \"change\" },\r\n        ]\r\n      },\r\n\r\n      menuPermission: [],  // 菜单权限树\r\n      operationPermissions:0, // 操作权限，默认允许查看，0：不允许操作，1：允许操作\r\n      choosedMenuIds:[], // 已勾选的菜单主键id\r\n      choosedMenuOnlyIds:[], // 已勾选的菜单唯一id\r\n      notLeaf:[], // 非叶子节点  数组\r\n      selectedItemPermissionsElement:[], // 默认勾选的节点的 key 的数组\r\n      roleNameLength:0, // 角色名称长度\r\n      descriptionLength:0, // 角色描述长度\r\n\r\n      base:1,   // 分辨率自适应 计算后的倍数\r\n      tabHeight:0,  // 分辨率自适应调整：表格的高度\r\n    }\r\n  },\r\n  created(){\r\n    this.queryMenuTree();\r\n  },\r\n  mounted(){\r\n    this.autoFix();\r\n  },\r\n\r\n  methods:{\r\n\r\n    /** 自适应 */\r\n    autoFix(){\r\n      let vm = this;\r\n      this.getDom();\r\n      window.onresize = function(){\r\n        vm.getDom();\r\n      }\r\n    },\r\n\r\n    /** 获取窗口的宽和高 */\r\n    getDom(){\r\n      let width = window.innerWidth;\r\n      let height = window.innerHeight;\r\n      this.base = (width-160)/(1024-160);\r\n      // this.tabHeight = height - 350;  // 表格页面有“过滤搜索条件”card，表格上方有Button，则采用该方式计算。\r\n      // this.tabHeight = height - 325;  // 表格页面有“过滤搜索条件”card，表格上方无Button，则采用该方式计算。\r\n      // this.tabHeight = height - 275;  // 表格页面无 “过滤搜索条件”card,但表格上方有Button，则采用该方式计算。\r\n      this.tabHeight = height - 130;   // 表格页面无 “过滤搜索条件”card,表格上方无Button，则采用该方式计算。\r\n    },\r\n\r\n    /** 获取 空的菜单权限树 */\r\n    queryMenuTree(){\r\n      let param = {\r\n        systemType:2,  //类型：String  必有字段  备注：系统类型：1代表BO，2代表数字录播，3代表云直播\r\n      }\r\n\r\n      this.menuPermission = [];\r\n      api.queryMenuTreeJson(param).then( \r\n        res => {\r\n          let result = res.result;\r\n          this.menuPermission = [];\r\n          for(let i = 0; i < result.length; i++){\r\n            this.jsonData(result[i]);\r\n          }\r\n          this.menuPermission = result;\r\n        }\r\n      )\r\n    },\r\n\r\n    /**对后台返回数据进行处理 在json数据中添加组件能够识别出来的键值 */\r\n    jsonData(jsonTree){ \r\n      if ((typeof jsonTree === 'object') && (jsonTree.constructor === Object.prototype.constructor)) {\r\n        var array = []\r\n        array.push(jsonTree)\r\n      } else {\r\n        array = jsonTree\r\n      }\r\n      \r\n      for(let i = 0; i < array.length; i++){\r\n        let jn = array[i];\r\n        if (jn.permissions.length !== 0) {\r\n          this.notLeaf.push(jn.id.toString())\r\n        }\r\n        jn.label = jn.name // 新增title属性 保证Tree组件识别\r\n        jn.children = jn.permissions // 新增children属性 保证Tree组件识别\r\n        jn.expand = true // 新增expand属性 保证菜单展开\r\n        if (jn.children && jn.children.length > 0) {\r\n          this.jsonData(jn.children)\r\n        } else if (jn.parentId === 0) {\r\n          jn.disabled = true\r\n        }\r\n      } \r\n    }, \r\n\r\n    /** 获取 用户勾选的（全选和半选）菜单信息 */\r\n    getUserChoosedMenuInfo(){\r\n      let halfChoosed = this.$refs.menuPermissionTree.getHalfCheckedNodes(); // 半选\r\n      let fullChoosed = this.$refs.menuPermissionTree.getCheckedNodes(); // 全选\r\n\r\n      this.choosedMenuIds = [];\r\n      this.choosedMenuOnlyIds = [];\r\n\r\n      for(let half of halfChoosed){\r\n        this.choosedMenuIds.push(half.id.toString());\r\n        this.choosedMenuOnlyIds.push(half.permissionId);\r\n      }\r\n      for(let full of fullChoosed){\r\n        this.choosedMenuIds.push(full.id.toString());\r\n        this.choosedMenuOnlyIds.push(full.permissionId);\r\n      }\r\n    },\r\n\r\n    checkAllGroup(checkData){\r\n      if(checkData.length === 2){\r\n        this.operationPermissions = 1;\r\n      } else if (checkData.length === 1) {\r\n        this.operationPermissions = 0;\r\n      }\r\n    },\r\n\r\n    cancelCreateRole(){ // 新建角色----取消\r\n      this.roleNameLength = 0;\r\n      this.descriptionLength = 0;\r\n      this.$router.push({\r\n        name:'system-manage-role'\r\n      })\r\n    },\r\n\r\n    confirmCreateRole(name){ // 新建角色----确定\r\n      this.getUserChoosedMenuInfo();\r\n      this.$refs[name].validate(valid => {\r\n        if(valid){\r\n          let param = {\r\n            roleName:this.roleNew.roleName,\r\n            roleDescription:this.roleNew.description,\r\n            permissionIds:this.choosedMenuIds,\r\n            permissionOnlyIds:this.choosedMenuOnlyIds,\r\n            operationPermissions:this.operationPermissions,\r\n          }\r\n          if(this.choosedMenuIds.length === 0 || this.choosedMenuOnlyIds.length === 0) {\r\n            this.$Message.error('请选择菜单');\r\n          } else {\r\n            api.roleCreateDrbs(param).then(\r\n              res => {\r\n                this.$Message.success('新建角色成功!');\r\n                this.choosedMenuIds = [];\r\n                this.choosedMenuOnlyIds = [];\r\n                this.operationPermissions = 0;\r\n                this.roleNameLength = 0;\r\n                this.descriptionLength = 0;\r\n                this.$router.push({\r\n                  name:'system-manage-role'\r\n                })\r\n              },\r\n              err => {\r\n                this.roleNameLength = 0;\r\n                this.descriptionLength = 0;\r\n              }\r\n            )\r\n          }\r\n\r\n        } \r\n      })\r\n    },\r\n\r\n    // 重置表单\r\n    handleReset (name) {\r\n      this.$refs[name].resetFields()\r\n    },\r\n  }\r\n}\r\n</script>\r\n<style >\r\n#enableOperation .ivu-checkbox-checked .ivu-checkbox-inner {\r\n  border-color:rgba(199,219,244,1);\r\n}\r\n#enableOperation {\r\n  margin-left: 46px;\r\n}\r\n#enableWatch {\r\n  margin-left: 32px;\r\n}\r\n\r\n#roleCreateTree .el-tree-node__content {\r\n  margin-top:10px;\r\n}\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./role-create.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./role-create.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./role-create.vue?vue&type=template&id=56fb0d0c&\"\nimport script from \"./role-create.vue?vue&type=script&lang=js&\"\nexport * from \"./role-create.vue?vue&type=script&lang=js&\"\nimport style0 from \"./role-create.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./role-create.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./role-create.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}