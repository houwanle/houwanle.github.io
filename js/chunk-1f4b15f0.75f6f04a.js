(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f4b15f0"],{"16e1":function(e,o,r){},"2d78":function(e,o,r){"use strict";var t=r("16e1"),s=r.n(t);s.a},"36e9":function(e,o,r){"use strict";r.r(o);var t=function(){var e=this,o=e.$createElement,r=e._self._c||o;return r("div",[r("div",{staticStyle:{width:"100%",height:"38px",background:"rgba(13,67,111,1)","box-shadow":"0px 2px 10px 0px rgba(0, 0, 0, 0.05)","font-size":"14px","font-family":"Microsoft YaHei","font-weight":"400",color:"rgba(255,255,255,1)","padding-left":"24px","line-height":"38px"}},[e._v(" 新建操作员 ")]),r("Row",[r("Col",[r("Card",{staticStyle:{margin:"10px"},style:{height:e.tabHeight+"px"}},[r("Row",{staticStyle:{"margin-top":"20px"},attrs:{type:"flex",justify:"center"}},[r("Col",[r("Form",{ref:"operatorNew",attrs:{model:e.operatorNew,rules:e.operatorNewRule,"label-position":"right","label-width":130}},[r("FormItem",{attrs:{label:"名称",prop:"operatorName"}},[r("Input",{staticStyle:{width:"466px",height:"32px"},attrs:{type:"text",maxlength:20,placeholder:"请输入"},model:{value:e.operatorNew.operatorName,callback:function(o){e.$set(e.operatorNew,"operatorName",o)},expression:"operatorNew.operatorName"}}),r("span",{staticStyle:{color:"rgba(175,188,204,1)","margin-left":"10px"}},[e._v(e._s(e.operatorNameLength)+"/20")])],1),r("FormItem",{attrs:{label:"密码",prop:"operatorPassword"}},[r("Input",{staticStyle:{width:"466px",height:"32px"},attrs:{type:"password",maxlength:20,placeholder:"请输入"},model:{value:e.operatorNew.operatorPassword,callback:function(o){e.$set(e.operatorNew,"operatorPassword",o)},expression:"operatorNew.operatorPassword"}}),r("span",{staticStyle:{color:"rgba(175,188,204,1)","margin-left":"10px"}},[e._v(e._s(e.operatorPasswordLength)+"/20")])],1),r("FormItem",{attrs:{label:"确认密码",prop:"operatorPasswordAgain"}},[r("Input",{staticStyle:{width:"466px",height:"32px"},attrs:{type:"password",maxlength:20,placeholder:"请输入"},model:{value:e.operatorNew.operatorPasswordAgain,callback:function(o){e.$set(e.operatorNew,"operatorPasswordAgain",o)},expression:"operatorNew.operatorPasswordAgain"}}),r("span",{staticStyle:{color:"rgba(175,188,204,1)","margin-left":"10px"}},[e._v(e._s(e.operatorPasswordAgainLength)+"/20")])],1),r("RadioGroup",{staticStyle:{"padding-left":"130px","padding-bottom":"10px"},on:{"on-change":e.selectedAuthority},model:{value:e.operatorNew.chooseAuthority,callback:function(o){e.$set(e.operatorNew,"chooseAuthority",o)},expression:"operatorNew.chooseAuthority"}},[r("Radio",{attrs:{label:"通过角色赋权限"}},[r("span",{staticStyle:{color:"rgba(255,255,255,1)"}},[e._v("通过角色赋权限")])]),r("Radio",{staticStyle:{"margin-left":"70px"},attrs:{label:"自定义权限"}},[r("span",{staticStyle:{color:"rgba(255,255,255,1)"}},[e._v("自定义权限")])])],1),r("FormItem",{directives:[{name:"show",rawName:"v-show",value:"通过角色赋权限"===e.operatorNew.chooseAuthority,expression:"operatorNew.chooseAuthority==='通过角色赋权限'"}],attrs:{label:"选择角色",prop:"chooseRole"}},[r("RadioGroup",{staticStyle:{overflow:"auto"},style:{height:e.tabHeight-320+"px"},attrs:{vertical:""},on:{"on-change":e.selectedRole},model:{value:e.operatorNew.chooseRole,callback:function(o){e.$set(e.operatorNew,"chooseRole",o)},expression:"operatorNew.chooseRole"}},e._l(e.roleList,(function(o,t){return r("div",{key:t},[r("Radio",{attrs:{label:o.roleId}},[r("span",{staticStyle:{color:"rgba(255,255,255,1)"}},[e._v(e._s(o.name)+"（"+e._s(o.description)+"）")])]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.operatorNew.chooseRole===o.roleId,expression:"operatorNew.chooseRole===item.roleId"}]},[r("Row",[r("Col",{staticStyle:{"margin-left":"30px",display:"flex","align-items":"flex-start"}},[r("span",{staticStyle:{color:"rgba(255,255,255,1)"}},[e._v("可访问的功能菜单")]),r("div",{staticStyle:{width:"300px",height:"240px",border:"1px solid rgba(87,111,140,1)","border-radius":"2px",overflow:"auto","margin-top":"10px","margin-left":"10px",background:"#163C69"}},[r("el-tree",{ref:"menuPermissionTree",refInFor:!0,attrs:{id:"adminCreateTree",data:e.menuPermission,"node-key":"id","default-checked-keys":e.selectedItemPermissionsElement,"show-checkbox":"","default-expand-all":""},on:{check:function(o,r){e.handleCheckChange(o,r)}}})],1)])],1),r("Row",[r("Col",{staticStyle:{"margin-left":"30px",display:"flex","align-items":"flex-start"}},[r("span",{staticStyle:{color:"rgba(255,255,255,1)"}},[e._v("可操作的权限")]),r("div",{staticStyle:{"margin-left":"10px"}},[r("CheckboxGroup",{staticStyle:{color:"rgba(255,255,255,1)"},on:{"on-change":e.checkAllGroup},model:{value:e.operatorNew.operationPermissionArray,callback:function(o){e.$set(e.operatorNew,"operationPermissionArray",o)},expression:"operatorNew.operationPermissionArray"}},[r("Checkbox",{attrs:{label:"允许查看",disabled:"",id:"enableWatch"}}),r("Checkbox",{attrs:{label:"允许操作",disabled:"",id:"enableOperation"}})],1)],1)])],1)],1)],1)})),0)],1),r("FormItem",{directives:[{name:"show",rawName:"v-show",value:"自定义权限"===e.operatorNew.chooseAuthority,expression:"operatorNew.chooseAuthority==='自定义权限'"}],attrs:{label:"可访问的功能菜单"}},[r("div",{staticStyle:{width:"464px",height:"260px",border:"1px solid #576F8C","border-radius":"2px",overflow:"auto","margin-top":"10px",background:"#163C69"},style:{height:e.tabHeight-400+"px"}},[r("el-tree",{attrs:{id:"adminCreateTree",data:e.menuPermission1,"node-key":"id","show-checkbox":"","default-expand-all":""},on:{check:function(o,r){e.handleCheckChange(o,r)}}})],1)]),r("FormItem",{directives:[{name:"show",rawName:"v-show",value:"自定义权限"===e.operatorNew.chooseAuthority,expression:"operatorNew.chooseAuthority==='自定义权限'"}],attrs:{label:"可操作的权限"}},[r("CheckboxGroup",{staticStyle:{color:"rgba(255,255,255,1)"},on:{"on-change":e.checkAllGroup1},model:{value:e.operatorNew.operationPermissionArray1,callback:function(o){e.$set(e.operatorNew,"operationPermissionArray1",o)},expression:"operatorNew.operationPermissionArray1"}},[r("Checkbox",{attrs:{label:"允许查看",disabled:"",id:"enableWatch"}}),r("Checkbox",{attrs:{label:"允许操作",id:"enableOperation"}})],1)],1),r("FormItem",{staticStyle:{"margin-left":"120px"}},[r("Button",{staticStyle:{background:"rgba(13,67,111,1)",color:"rgba(199,219,244,1)"},on:{click:e.cancelCreateOperator}},[e._v("取消")]),r("Button",{staticStyle:{"margin-left":"49px"},attrs:{type:"primary"},on:{click:function(o){return e.confirmCreateOperator("operatorNew")}}},[e._v("确定")])],1)],1)],1)],1)],1)],1)],1)],1)},s=[],a=(r("c975"),r("b0c0"),r("d3b7"),r("25f0"),r("53ca")),i=r("b85c"),n=r("4ec3"),l={data:function(){var e=this,o=function(o,r,t){return r?r.length>20?(e.operatorNameLength=r.length,t(new Error("操作员名称过长,请重新输入!"))):(e.operatorNameLength=r.length,void t()):(e.operatorNameLength=0,t(new Error("操作员名称不能为空!")))},r=function(o,r,t){e.operatorPasswordLength=r.length,""===r?t(new Error("操作员密码不能为空!")):r.length>20?(e.operatorPasswordLength=r.length,t(new Error("操作员密码过长,请重新输入!"))):(e.operatorPasswordLength=r.length,t())},t=function(o,r,t){""===r?t(new Error("操作员确认密码不能为空!")):r!==e.operatorNew.operatorPassword?t(new Error("两次输入密码不一致，请重新输入!")):r.length>20?(e.operatorPasswordAgainLength=r.length,t(new Error("操作员确认密码过长,请重新输入!"))):(e.operatorPasswordAgainLength=r.length,t())},s=function(o,r,t){e.operatorPasswordAgainLength=r.length,t()};return{operatorNew:{operatorName:"",operatorPassword:"",operatorPasswordAgain:"",chooseAuthority:"通过角色赋权限",chooseRole:"",operationPermissionArray:["允许查看"],operationPermissionArray1:["允许查看"]},operatorNewRule:{operatorName:[{required:!0,validator:o,trigger:"change"}],operatorPassword:[{required:!0,validator:r,trigger:"change"},{pattern:/^(?![a-zA-z]+$)(?!\d+$)(?![!@#$&*]+$)[a-zA-Z\d!@#$&*]+$/,message:"请输入长度4-20位英文、 数字、特殊字符（!，@，#，$，&，*）任意两种组合",trigger:"blur"},{min:4,message:"输入字符长度不允许小于4",trigger:"blur"},{max:20,message:"输入字符长度不允许超出20",trigger:"blur"}],operatorPasswordAgain:[{required:!0,validator:t,trigger:"blur"},{required:!0,validator:s,trigger:"change"},{max:20,message:"输入字符长度不允许超出20",trigger:"blur"}]},roleList:[],operationPermissions:0,operationPermissions1:0,roleIds:[],roleOnlyIds:[],menuPermission:[],menuPermission1:[],selectedItemPermissionsElement:[],permissionIds:[],permissionOnlyIds:[],choosedMenuIds:[],choosedMenuOnlyIds:[],notLeaf:[],operatorNameLength:0,operatorPasswordLength:0,operatorPasswordAgainLength:0,selectedItemPermissions:[],selectedItemNewPermissions:[],base:1,tabHeight:0}},created:function(){this.queryRoleList()},mounted:function(){this.autoFix()},methods:{autoFix:function(){var e=this;this.getDom(),window.onresize=function(){e.getDom()}},getDom:function(){var e=window.innerWidth,o=window.innerHeight;this.base=(e-160)/864,this.tabHeight=o-130},queryRoleList:function(){var e=this,o={status:0};n["a"].roleSearchListByName(o).then((function(o){o.result&&(e.roleList=o.result)}))},selectedRole:function(e){var o,r;this.roleIds=[],this.roleOnlyIds=[];var t,s=Object(i["a"])(this.roleList);try{for(s.s();!(t=s.n()).done;){var a=t.value;e===a.roleId&&(this.queryRoleInfo(a),o=a.id,r=a.roleId)}}catch(n){s.e(n)}finally{s.f()}this.roleIds.push(o),this.roleOnlyIds.push(r)},selectedAuthority:function(e){console.log("赋权限方式",e),this.operatorNew.chooseAuthority=e,this.getTheWholeTree1()},queryRoleInfo:function(e){this.queryRolePermission(e),this.operatorNew.operationPermissionArray=["允许查看"],this.operationPermissions=e.operationPermissions,1===this.operationPermissions&&(this.operatorNew.operationPermissionArray=["允许查看","允许操作"])},queryRolePermission:function(e){var o=this;if(e){var r={id:e.id,roleId:e.roleId};n["a"].getSelectedItemPermissions(r).then((function(e){e=e.result;var r=[],t=[];if(e.length>0)for(var s=0;s<e.length;s++)r.push(parseInt(e[s].id)),t.push(e[s].permissionId);o.selectedItemPermissions=r,o.selectedItemNewPermissions=t,o.getTheWholeTree(e)}))}},getTheWholeTree:function(e){var o=this,r={systemType:"2"};n["a"].searchMenuList(r).then((function(r){r=r.result,o.menuPermission=[];for(var t=0;t<r.length;t++)o.jsonData(r[t]);o.selectedItemPermissionsElement=[];var s,a=Object(i["a"])(e);try{for(a.s();!(s=a.n()).done;){var n=s.value;-1===o.notLeaf.indexOf(n.id)&&o.selectedItemPermissionsElement.push(parseInt(n.id))}}catch(l){a.e(l)}finally{a.f()}o.menuPermission=r}))},getTheWholeTree1:function(){var e=this,o={systemType:"2"};n["a"].searchMenuList(o).then((function(o){o=o.result,e.menuPermission1=[];for(var r=0;r<o.length;r++)e.jsonData(o[r]);e.menuPermission1=o}))},jsonData:function(e){if("object"===Object(a["a"])(e)&&e.constructor===Object.prototype.constructor){var o=[];o.push(e)}else o=e;for(var r=0;r<o.length;r++){var t=o[r];0!==t.permissions.length&&this.notLeaf.push(t.id.toString()),t.label=t.name,t.children=t.permissions,t.expand=!0,"通过角色赋权限"===this.operatorNew.chooseAuthority?t.disabled=!0:"自定义权限"===this.operatorNew.chooseAuthority&&(t.disabled=!1),t.children&&t.children.length>0?this.jsonData(t.children):0===t.parentId&&(t.disabled=!0)}},handleCheckChange:function(e,o){var r=o.checkedNodes,t=o.halfCheckedNodes;this.choosedMenuIds=[],this.choosedMenuOnlyIds=[];var s,a=Object(i["a"])(r);try{for(a.s();!(s=a.n()).done;){var n=s.value;this.choosedMenuIds.push(n.id),this.choosedMenuOnlyIds.push(n.permissionId)}}catch(c){a.e(c)}finally{a.f()}var l,h=Object(i["a"])(t);try{for(h.s();!(l=h.n()).done;){var p=l.value;this.choosedMenuIds.push(p.id),this.choosedMenuOnlyIds.push(p.permissionId)}}catch(c){h.e(c)}finally{h.f()}},checkAllGroup:function(e){2===e.length?this.operationPermissions=1:1===e.length&&(this.operationPermissions=0)},checkAllGroup1:function(e){2===e.length?this.operationPermissions1=1:1===e.length&&(this.operationPermissions1=0)},cancelCreateOperator:function(){this.operatorNameLength=0,this.operatorPasswordLength=0,this.operatorPasswordAgainLength=0,this.$router.push({name:"system-manage-admin"})},confirmCreateOperator:function(e){var o=this;"通过角色赋权限"===this.operatorNew.chooseAuthority?this.$refs[e].validate((function(e){if(e){if(0===o.roleIds.length||0===o.roleOnlyIds.length)return o.$Message.info("请选择角色"),!1;if(0===o.selectedItemPermissions.length||0===o.selectedItemNewPermissions.length)return o.$Message.info("请选择菜单"),!1;var r={userName:o.operatorNew.operatorName,password:btoa(encodeURI(o.operatorNew.operatorPassword)),operationPermissions:o.operationPermissions,roleIds:o.roleIds,roleOnlyIds:o.roleOnlyIds,permissionIds:o.selectedItemPermissions,permissionOnlyIds:o.selectedItemNewPermissions};n["a"].createOperatorJson(r).then((function(e){o.$Message.success("新建操作员成功!"),o.roleIds=[],o.roleOnlyIds=[],o.permissionIds=[],o.permissionOnlyIds=[],o.operationPermissions=0,o.operatorNameLength=0,o.operatorPasswordLength=0,o.operatorPasswordAgainLength=0,o.$router.push({name:"system-manage-admin"})}),(function(e){o.operatorNameLength=0,o.operatorPasswordLength=0,o.operatorPasswordAgainLength=0}))}})):"自定义权限"===this.operatorNew.chooseAuthority&&this.$refs[e].validate((function(e){if(e){if(o.choosedMenuIds&&0===o.choosedMenuIds.length)return o.$Message.info("请选择菜单"),!1;var r={userName:o.operatorNew.operatorName,password:btoa(encodeURI(o.operatorNew.operatorPassword)),operationPermissions:o.operationPermissions1,permissionIds:o.choosedMenuIds,permissionOnlyIds:o.choosedMenuOnlyIds};n["a"].createOperatorJson(r).then((function(e){o.$Message.success("新建操作员成功!"),o.operationPermissions1=0,o.operatorNameLength=0,o.operatorPasswordLength=0,o.operatorPasswordAgainLength=0,o.$router.push({name:"system-manage-admin"})}),(function(e){o.operatorNameLength=0,o.operatorPasswordLength=0,o.operatorPasswordAgainLength=0}))}}))},handleReset:function(e){this.$refs[e].resetFields()}}},h=l,p=(r("2d78"),r("2877")),c=Object(p["a"])(h,t,s,!1,null,null,null);o["default"]=c.exports}}]);
//# sourceMappingURL=chunk-1f4b15f0.75f6f04a.js.map